"use strict";(self.webpackChunkarcgis_node=self.webpackChunkarcgis_node||[]).push([[2163],{16575:(t,e,i)=>{i.d(e,{A:()=>s});class s{constructor(t){this.size=0,this._start=0,this.maxSize=t,this._buffer=new Array(t)}get entries(){return this._buffer}enqueue(t){if(this.size===this.maxSize){const e=this._buffer[this._start];return this._buffer[this._start]=t,this._start=(this._start+1)%this.maxSize,e}return this._buffer[(this._start+this.size++)%this.maxSize]=t,null}dequeue(){if(0===this.size)return null;const t=this._buffer[this._start];return this._buffer[this._start]=null,this.size--,this._start=(this._start+1)%this.maxSize,t}peek(){return 0===this.size?null:this._buffer[this._start]}peekLast(){return 0===this.size?null:this._buffer[(this._start+(this.size-1))%this.maxSize]}find(t){if(0===this.size)return null;for(const e of this._buffer)if(null!=e&&t(e))return e;return null}clear(t){let e=this.dequeue();for(;null!=e;)t&&t(e),e=this.dequeue()}}},16269:(t,e,i)=>{i.d(e,{A:()=>h});var s,r=i(6273),n=i(39744);!function(t){t[t.varint=0]="varint",t[t.fixed64=1]="fixed64",t[t.delimited=2]="delimited",t[t.fixed32=5]="fixed32",t[t.unknown=99]="unknown"}(s||(s={}));const o=4294967296,a=new TextDecoder("utf-8"),c=(0,r.A)("safari")||(0,r.A)("ios")?6:(0,r.A)("ff")?12:32;class h{constructor(t,e,i=0,r=(t?t.byteLength:0)){this._tag=0,this._dataType=s.unknown,this._init(t,e,i,r)}_init(t,e,i,s){this._data=t,this._dataView=e,this._pos=i,this._end=s}asUnsafe(){return this}clone(){return new h(this._data,this._dataView,this._pos,this._end)}pos(){return this._pos}move(t){this._pos=t}nextTag(t){for(;;){if(this._pos===this._end)return!1;const e=this._decodeVarint();if(this._tag=e>>3,this._dataType=7&e,!t||t===this._tag)break;this.skip()}return!0}next(){if(this._pos===this._end)return!1;const t=this._decodeVarint();return this._tag=t>>3,this._dataType=7&t,!0}empty(){return this._pos>=this._end}tag(){return this._tag}getInt32(){return this._decodeVarint()}getInt64(){return this._decodeVarint()}getUInt32(){let t=4294967295;if(t=(127&this._data[this._pos])>>>0,this._data[this._pos++]<128)return t;if(t=(t|(127&this._data[this._pos])<<7)>>>0,this._data[this._pos++]<128)return t;if(t=(t|(127&this._data[this._pos])<<14)>>>0,this._data[this._pos++]<128)return t;if(t=(t|(127&this._data[this._pos])<<21)>>>0,this._data[this._pos++]<128)return t;if(t=(t|(15&this._data[this._pos])<<28)>>>0,this._data[this._pos++]<128)return t;throw new Error("Varint overflow")}getUInt64(){return this._decodeVarint()}getSInt32(){const t=this.getUInt32();return t>>>1^-(1&t)}getSInt64(){return this._decodeSVarint()}getBool(){const t=0!==this._data[this._pos];return this._skip(1),t}getEnum(){return this._decodeVarint()}getFixed64(){const t=this._dataView,e=this._pos,i=t.getUint32(e,!0)+t.getUint32(e+4,!0)*o;return this._skip(8),i}getSFixed64(){const t=this._dataView,e=this._pos,i=t.getUint32(e,!0)+t.getInt32(e+4,!0)*o;return this._skip(8),i}getDouble(){const t=this._dataView.getFloat64(this._pos,!0);return this._skip(8),t}getFixed32(){const t=this._dataView.getUint32(this._pos,!0);return this._skip(4),t}getSFixed32(){const t=this._dataView.getInt32(this._pos,!0);return this._skip(4),t}getFloat(){const t=this._dataView.getFloat32(this._pos,!0);return this._skip(4),t}getString(){const t=this._getLength(),e=this._pos,i=this._toString(this._data,e,e+t);return this._skip(t),i}getBytes(){const t=this._getLength(),e=this._pos,i=this._toBytes(this._data,e,e+t);return this._skip(t),i}getLength(){return this._getLengthUnsafe()}processMessageWithArgs(t,e,i,s){const r=this.getMessage(),n=t(r,e,i,s);return r.release(),n}processMessage(t){const e=this.getMessage(),i=t(e);return e.release(),i}getMessage(){const t=this._getLength(),e=h.pool.acquire();return e._init(this._data,this._dataView,this._pos,this._pos+t),this._skip(t),e}release(){h.pool.release(this)}dataType(){return this._dataType}skip(){switch(this._dataType){case s.varint:this._decodeVarint();break;case s.fixed64:this._skip(8);break;case s.delimited:this._skip(this._getLength());break;case s.fixed32:this._skip(4);break;default:throw new Error("Invalid data type!")}}skipLen(t){this._skip(t)}_skip(t){if(this._pos+t>this._end)throw new Error("Attempt to skip past the end of buffer!");this._pos+=t}_decodeVarint(){const t=this._data;let e=this._pos,i=0,s=0;if(this._end-e>=10)do{if(s=t[e++],i|=127&s,!(128&s))break;if(s=t[e++],i|=(127&s)<<7,!(128&s))break;if(s=t[e++],i|=(127&s)<<14,!(128&s))break;if(s=t[e++],i|=(127&s)<<21,!(128&s))break;if(s=t[e++],i+=268435456*(127&s),!(128&s))break;if(s=t[e++],i+=34359738368*(127&s),!(128&s))break;if(s=t[e++],i+=4398046511104*(127&s),!(128&s))break;if(s=t[e++],i+=562949953421312*(127&s),!(128&s))break;if(s=t[e++],i+=72057594037927940*(127&s),!(128&s))break;if(s=t[e++],i+=0x8000000000000000*(127&s),!(128&s))break;throw new Error("Varint too long!")}while(0);else{let r=1;for(;e!==this._end&&(s=t[e],128&s);)++e,i+=(127&s)*r,r*=128;if(e===this._end)throw new Error("Varint overrun!");++e,i+=s*r}return this._pos=e,i}_decodeSVarint(){const t=this._data;let e,i=0,s=0;const r=1&t[this._pos];if(s=t[this._pos++],i|=127&s,!(128&s))return r?-(i+1)/2:i/2;if(s=t[this._pos++],i|=(127&s)<<7,!(128&s))return r?-(i+1)/2:i/2;if(s=t[this._pos++],i|=(127&s)<<14,!(128&s))return r?-(i+1)/2:i/2;if(s=t[this._pos++],i|=(127&s)<<21,!(128&s))return r?-(i+1)/2:i/2;if(s=t[this._pos++],i+=268435456*(127&s),!(128&s))return r?-(i+1)/2:i/2;if(s=t[this._pos++],i+=34359738368*(127&s),!(128&s))return r?-(i+1)/2:i/2;if(s=t[this._pos++],i+=4398046511104*(127&s),!(128&s))return r?-(i+1)/2:i/2;if(e=BigInt(i),s=t[this._pos++],e+=0x2000000000000n*BigInt(127&s),!(128&s))return Number(r?-(e+1n)/2n:e/2n);if(s=t[this._pos++],e+=0x100000000000000n*BigInt(127&s),!(128&s))return Number(r?-(e+1n)/2n:e/2n);if(s=t[this._pos++],e+=0x8000000000000000n*BigInt(127&s),!(128&s))return Number(r?-(e+1n)/2n:e/2n);throw new Error("Varint too long!")}_getLength(){if(this._dataType!==s.delimited)throw new Error("Not a delimited data type!");return this._decodeVarint()}_getLengthUnsafe(){return this.getUInt32()}_toString(t,e,i){if((i=Math.min(this._end,i))-e>c){const s=t.subarray(e,i);return a.decode(s)}let s="",r="";for(let n=e;n<i;++n){const e=t[n];128&e?r+="%"+e.toString(16):(s+=decodeURIComponent(r)+String.fromCharCode(e),r="")}return r.length&&(s+=decodeURIComponent(r)),s}_toBytes(t,e,i){return i=Math.min(this._end,i),new Uint8Array(t.buffer,e,i-e)}}h.pool=new n.A(h,void 0,(t=>{t._data=null,t._dataView=null}))},20472:(t,e,i)=>{i.d(e,{F:()=>c,l:()=>h});var s=i(44764),r=i(6273);const n=128e3;let o=null,a=null;async function c(){return o||(o=async function(){const t=(0,r.A)("esri-csp-restrictions")?await i.e(2512).then(i.bind(i,62512)).then((t=>t.l)):await i.e(4250).then(i.bind(i,74250)).then((t=>t.l));a=await t.default({locateFile:t=>(0,s.s)(`esri/core/libs/libtess/${t}`)})}()),o}function h(t,e){const i=Math.max(t.length,n);return a.triangulate(t,e,i)}},92524:(t,e,i)=>{i.d(e,{V:()=>h});var s=i(52266),r=i(54481),n=i(19388),o=i(32199),a=i(52644);const c=96/72;class h{static executeEffects(t,e,i,s){const r=c,h=(0,a.ll)(t);let u=new n.k(e);for(const e of t){const t=(0,o.A)(e);t&&(u=t.execute(u,e,r,i,s,h))}return u}static applyEffects(t,e,i){if(!t)return e;const c=(0,a.ll)(t);let h,u=new n.k(s.z.fromJSONCIM(e));for(const e of t){const t=(0,o.A)(e);t&&(u=t.execute(u,e,1,null,i,c))}const l=[];let p=null;for(;h=u.next();)l.push(...(0,r.x)(h)),p=h.geometryType;return 0===l.length||null===p?null:"esriGeometryPolygon"===p?{rings:l}:{paths:l}}}},91954:(t,e,i)=>{i.d(e,{l:()=>r});var s=i(32199);class r{static getPlacement(t,e,i,r,n,o){const a=(0,s.c)(i);return a?(-1===e&&t.invertY(),a.execute(t,i,r,n,o)):null}}},73274:(t,e,i)=>{i.d(e,{i:()=>f});var s=i(85953),r=i(6538);function n(t,e){return t.x===e.x&&t.y===e.y}function o(t){if(!t)return;const e=t.length;if(e<=1)return;let i=0;for(let s=1;s<e;s++)n(t[s],t[i])||++i===s||(t[i]=t[s]);t.length=i+1}function a(t,e){return t.x=e.y,t.y=-e.x,t}function c(t,e){return t.x=-e.y,t.y=e.x,t}function h(t,e){return t.x=e.x,t.y=e.y,t}function u(t,e){return t.x=-e.x,t.y=-e.y,t}function l(t){return Math.sqrt(t.x*t.x+t.y*t.y)}function p(t,e){return t.x*e.y-t.y*e.x}function d(t,e){return t.x*e.x+t.y*e.y}function x(t,e,i,s){return t.x=e.x*i+e.y*s,t.y=e.x*s-e.y*i,t}class f{constructor(t,e,i){this._writeVertex=t,this._writeTriangle=e,this._canUseThinTessellation=i,this._prevNormal={x:void 0,y:void 0},this._nextNormal={x:void 0,y:void 0},this._textureNormalLeft={x:0,y:1},this._textureNormalRight={x:0,y:-1},this._textureNormal={x:void 0,y:void 0},this._joinNormal={x:void 0,y:void 0},this._inner={x:void 0,y:void 0},this._outer={x:void 0,y:void 0},this._roundStart={x:void 0,y:void 0},this._roundEnd={x:void 0,y:void 0},this._startBreak={x:void 0,y:void 0},this._endBreak={x:void 0,y:void 0},this._innerPrev={x:void 0,y:void 0},this._innerNext={x:void 0,y:void 0},this._bevelStart={x:void 0,y:void 0},this._bevelEnd={x:void 0,y:void 0},this._bevelMiddle={x:void 0,y:void 0}}tessellate(t,e,i=this._canUseThinTessellation){o(t),i&&e.halfWidth<r.Gh&&!e.offset?this._tessellateThin(t,e):this._tessellate(t,e)}_tessellateThin(t,e){if(t.length<2)return;const i=e.wrapDistance||65535;let s=e.initialDistance||0,r=!1,n=t[0].x,o=t[0].y;const a=t.length;for(let e=1;e<a;++e){r&&(r=!1,s=0);let a=t[e].x,c=t[e].y,h=a-n,u=c-o,l=Math.sqrt(h*h+u*u);if(h/=l,u/=l,s+l>i){r=!0;const t=(i-s)/l;l=i-s,a=(1-t)*n+t*a,c=(1-t)*o+t*c,--e}const p=this._writeVertex(n,o,0,0,h,u,u,-h,0,-1,s),d=this._writeVertex(n,o,0,0,h,u,-u,h,0,1,s);s+=l;const x=this._writeVertex(a,c,0,0,h,u,u,-h,0,-1,s),f=this._writeVertex(a,c,0,0,h,u,-u,h,0,1,s);this._writeTriangle(p,d,x),this._writeTriangle(d,x,f),n=a,o=c}}_tessellate(t,e){const i=t[0],r=t[t.length-1],o=n(i,r),f=o?3:2;if(t.length<f)return;const y=e.pixelCoordRatio,_=null!=e.capType?e.capType:s.xR.BUTT,m=null!=e.joinType?e.joinType:s.JO.MITER,g=null!=e.miterLimit?Math.min(e.miterLimit,4):2,w=null!=e.roundLimit?Math.min(e.roundLimit,1.05):1.05,k=null!=e.halfWidth?e.halfWidth:2,v=!!e.textured;let b,T,S,P=null;const E=this._prevNormal,z=this._nextNormal;let M=-1,L=-1;const I=this._joinNormal;let N,B;const A=this._textureNormalLeft,R=this._textureNormalRight,D=this._textureNormal;let Y=-1,V=-1;const F=e.wrapDistance||65535;let O=e.initialDistance||0;const G=this._writeVertex,U=this._writeTriangle,C=(t,e,i,s,r,n)=>{const o=G(T,S,N,B,i,s,t,e,r,n,O);return Y>=0&&V>=0&&o>=0&&U(Y,V,o),Y=V,V=o,o};o&&(b=t[t.length-2],z.x=r.x-b.x,z.y=r.y-b.y,L=l(z),z.x/=L,z.y/=L);let W=!1;for(let e=0;e<t.length;++e){if(W&&(W=!1,O=0),b&&(E.x=-z.x,E.y=-z.y,M=L,O+M>F&&(W=!0)),W){const i=(F-O)/M;M=F-O,b={x:(1-i)*b.x+i*t[e].x,y:(1-i)*b.y+i*t[e].y},--e}else b=t[e];T=b.x,S=b.y;const i=e<=0&&!W,r=e===t.length-1;if(i||(O+=M),P=r?o?t[1]:null:t[e+1],P?(z.x=P.x-T,z.y=P.y-S,L=l(z),z.x/=L,z.y/=L):(z.x=void 0,z.y=void 0),!o){if(i){c(I,z),N=I.x,B=I.y,_===s.xR.SQUARE&&(C(-z.y-z.x,z.x-z.y,z.x,z.y,0,-1),C(z.y-z.x,-z.x-z.y,z.x,z.y,0,1)),_===s.xR.ROUND&&(C(-z.y-z.x,z.x-z.y,z.x,z.y,-1,-1),C(z.y-z.x,-z.x-z.y,z.x,z.y,-1,1)),_!==s.xR.ROUND&&_!==s.xR.BUTT||(C(-z.y,z.x,z.x,z.y,0,-1),C(z.y,-z.x,z.x,z.y,0,1));continue}if(r){a(I,E),N=I.x,B=I.y,_!==s.xR.ROUND&&_!==s.xR.BUTT||(C(E.y,-E.x,-E.x,-E.y,0,-1),C(-E.y,E.x,-E.x,-E.y,0,1)),_===s.xR.SQUARE&&(C(E.y-E.x,-E.x-E.y,-E.x,-E.y,0,-1),C(-E.y-E.x,E.x-E.y,-E.x,-E.y,0,1)),_===s.xR.ROUND&&(C(E.y-E.x,-E.x-E.y,-E.x,-E.y,1,-1),C(-E.y-E.x,E.x-E.y,-E.x,-E.y,1,1));continue}}let n,f,G=-p(E,z);if(Math.abs(G)<.01)d(E,z)>0?(I.x=E.x,I.y=E.y,G=1,n=Number.MAX_VALUE,f=!0):(c(I,z),G=1,n=1,f=!1);else{I.x=(E.x+z.x)/G,I.y=(E.y+z.y)/G,n=l(I);const t=(n-1)*k*y;f=n>4||t>M&&t>L}N=I.x,B=I.y;let U=m;switch(m){case s.JO.BEVEL:n<1.05&&(U=s.JO.MITER);break;case s.JO.ROUND:n<w&&(U=s.JO.MITER);break;case s.JO.MITER:n>g&&(U=s.JO.BEVEL)}switch(U){case s.JO.MITER:if(C(I.x,I.y,-E.x,-E.y,0,-1),C(-I.x,-I.y,-E.x,-E.y,0,1),r)break;if(v){const t=W?0:O;Y=this._writeVertex(T,S,N,B,z.x,z.y,I.x,I.y,0,-1,t),V=this._writeVertex(T,S,N,B,z.x,z.y,-I.x,-I.y,0,1,t)}break;case s.JO.BEVEL:{const t=G<0;let e,i,s,n;if(t){const t=Y;Y=V,V=t,e=A,i=R}else e=R,i=A;if(f)s=t?c(this._innerPrev,E):a(this._innerPrev,E),n=t?a(this._innerNext,z):c(this._innerNext,z);else{const e=t?u(this._inner,I):h(this._inner,I);s=e,n=e}const o=t?a(this._bevelStart,E):c(this._bevelStart,E);C(s.x,s.y,-E.x,-E.y,e.x,e.y);const l=C(o.x,o.y,-E.x,-E.y,i.x,i.y);if(r)break;const p=t?c(this._bevelEnd,z):a(this._bevelEnd,z);if(f){const t=this._writeVertex(T,S,N,B,-E.x,-E.y,0,0,0,0,O);Y=this._writeVertex(T,S,N,B,z.x,z.y,n.x,n.y,e.x,e.y,O),V=this._writeVertex(T,S,N,B,z.x,z.y,p.x,p.y,i.x,i.y,O),this._writeTriangle(l,t,V)}else{if(v){const t=this._bevelMiddle;t.x=(o.x+p.x)/2,t.y=(o.y+p.y)/2,x(D,t,-E.x,-E.y),C(t.x,t.y,-E.x,-E.y,D.x,D.y),x(D,t,z.x,z.y),Y=this._writeVertex(T,S,N,B,z.x,z.y,t.x,t.y,D.x,D.y,O),V=this._writeVertex(T,S,N,B,z.x,z.y,n.x,n.y,e.x,e.y,O)}else{const t=Y;Y=V,V=t}C(p.x,p.y,z.x,z.y,i.x,i.y)}if(t){const t=Y;Y=V,V=t}break}case s.JO.ROUND:{const t=G<0;let e,i;if(t){const t=Y;Y=V,V=t,e=A,i=R}else e=R,i=A;const s=t?u(this._inner,I):h(this._inner,I);let o,l;f?(o=t?c(this._innerPrev,E):a(this._innerPrev,E),l=t?a(this._innerNext,z):c(this._innerNext,z)):(o=s,l=s);const p=t?a(this._roundStart,E):c(this._roundStart,E),y=t?c(this._roundEnd,z):a(this._roundEnd,z),_=C(o.x,o.y,-E.x,-E.y,e.x,e.y),m=C(p.x,p.y,-E.x,-E.y,i.x,i.y);if(r)break;const g=this._writeVertex(T,S,N,B,-E.x,-E.y,0,0,0,0,O);f||this._writeTriangle(Y,V,g);const w=u(this._outer,s),k=this._writeVertex(T,S,N,B,z.x,z.y,y.x,y.y,i.x,i.y,O);let b,P;const M=n>2;if(M){let e;n!==Number.MAX_VALUE?(w.x/=n,w.y/=n,e=d(E,w),e=(n*(e*e-1)+1)/e):e=-1,b=t?a(this._startBreak,E):c(this._startBreak,E),b.x+=E.x*e,b.y+=E.y*e,P=t?c(this._endBreak,z):a(this._endBreak,z),P.x+=z.x*e,P.y+=z.y*e}x(D,w,-E.x,-E.y);const L=this._writeVertex(T,S,N,B,-E.x,-E.y,w.x,w.y,D.x,D.y,O);x(D,w,z.x,z.y);const F=v?this._writeVertex(T,S,N,B,z.x,z.y,w.x,w.y,D.x,D.y,O):L,U=g,W=v?this._writeVertex(T,S,N,B,z.x,z.y,0,0,0,0,O):g;let X=-1,H=-1;if(M&&(x(D,b,-E.x,-E.y),X=this._writeVertex(T,S,N,B,-E.x,-E.y,b.x,b.y,D.x,D.y,O),x(D,P,z.x,z.y),H=this._writeVertex(T,S,N,B,z.x,z.y,P.x,P.y,D.x,D.y,O)),v?M?(this._writeTriangle(U,m,X),this._writeTriangle(U,X,L),this._writeTriangle(W,F,H),this._writeTriangle(W,H,k)):(this._writeTriangle(U,m,L),this._writeTriangle(W,F,k)):M?(this._writeTriangle(g,m,X),this._writeTriangle(g,X,H),this._writeTriangle(g,H,k)):(this._writeTriangle(g,m,L),this._writeTriangle(g,F,k)),f?(Y=this._writeVertex(T,S,N,B,z.x,z.y,l.x,l.y,e.x,e.y,O),V=k):(Y=v?this._writeVertex(T,S,N,B,z.x,z.y,l.x,l.y,e.x,e.y,O):_,this._writeTriangle(Y,W,k),V=k),t){const t=Y;Y=V,V=t}break}}}}}},93548:(t,e,i)=>{i.d(e,{uS:()=>G,FE:()=>O,lO:()=>V,XZ:()=>F});i(91814);var s=i(20472),r=i(15303),n=i(65977),o=i(6538);function a(t,e,i,s,r,n,o){N=0;const a=(s-i)*n,h=r&&r.length,l=h?(r[0]-i)*n:a;let p,d,x,f,_,m=c(e,i,s,0,l,n,!0);if(m&&m.next!==m.prev){if(h&&(m=y(e,i,s,r,m,n)),a>80*n){p=x=e[0+i*n],d=f=e[1+i*n];for(let t=n;t<l;t+=n){const s=e[t+i*n],r=e[t+1+i*n];p=Math.min(p,s),d=Math.min(d,r),x=Math.max(x,s),f=Math.max(f,r)}_=Math.max(x-p,f-d),_=0!==_?1/_:0}u(m,t,n,p,d,_,o,0)}}function c(t,e,i,s,r,n,o){let a;if(o===function(t,e,i,s,r,n){let o=0;for(let i=s,a=r-n;i<r;i+=n)o+=(t[a+e*n]-t[i+e*n])*(t[i+1+e*n]+t[a+1+e*n]),a=i;return o}(t,e,0,s,r,n)>0)for(let i=s;i<r;i+=n)a=d(i+e*n,t[i+e*n],t[i+1+e*n],a);else for(let i=r-n;i>=s;i-=n)a=d(i+e*n,t[i+e*n],t[i+1+e*n],a);return a&&T(a,a.next)&&(x(a),a=a.next),a}function h(t,e=t){if(!t)return t;let i,s=t;do{if(i=!1,s.steiner||!T(s,s.next)&&0!==g(s.prev,s,s.next))s=s.next;else{if(x(s),s=e=s.prev,s===s.next)break;i=!0}}while(i||s!==e);return e}function u(t,e,i,s,r,n,o,a){if(!t)return;!a&&n&&(t=m(t,s,r,n));let c=t;for(;t.prev!==t.next;){const d=t.prev,f=t.next;if(n?p(t,s,r,n):l(t))e.push(d.index/i+o),e.push(t.index/i+o),e.push(f.index/i+o),x(t),t=f.next,c=f.next;else if((t=f)===c){a?1===a?u(t=P(t,e,i,o),e,i,s,r,n,o,2):2===a&&E(t,e,i,s,r,n,o):u(h(t),e,i,s,r,n,o,1);break}}}function l(t){const e=t.prev,i=t,s=t.next;if(g(e,i,s)>=0)return!1;let r=t.next.next;const n=r;let o=0;for(;r!==t.prev&&(0===o||r!==n);){if(o++,k(e.x,e.y,i.x,i.y,s.x,s.y,r.x,r.y)&&g(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function p(t,e,i,s){const r=t.prev,n=t,o=t.next;if(g(r,n,o)>=0)return!1;const a=r.x<n.x?r.x<o.x?r.x:o.x:n.x<o.x?n.x:o.x,c=r.y<n.y?r.y<o.y?r.y:o.y:n.y<o.y?n.y:o.y,h=r.x>n.x?r.x>o.x?r.x:o.x:n.x>o.x?n.x:o.x,u=r.y>n.y?r.y>o.y?r.y:o.y:n.y>o.y?n.y:o.y,l=b(a,c,e,i,s),p=b(h,u,e,i,s);let d=t.prevZ,x=t.nextZ;for(;d&&d.z>=l&&x&&x.z<=p;){if(d!==t.prev&&d!==t.next&&k(r.x,r.y,n.x,n.y,o.x,o.y,d.x,d.y)&&g(d.prev,d,d.next)>=0)return!1;if(d=d.prevZ,x!==t.prev&&x!==t.next&&k(r.x,r.y,n.x,n.y,o.x,o.y,x.x,x.y)&&g(x.prev,x,x.next)>=0)return!1;x=x.nextZ}for(;d&&d.z>=l;){if(d!==t.prev&&d!==t.next&&k(r.x,r.y,n.x,n.y,o.x,o.y,d.x,d.y)&&g(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;x&&x.z<=p;){if(x!==t.prev&&x!==t.next&&k(r.x,r.y,n.x,n.y,o.x,o.y,x.x,x.y)&&g(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function d(t,e,i,s){const r=L.create(t,e,i);return s?(r.next=s.next,r.prev=s,s.next.prev=r,s.next=r):(r.prev=r,r.next=r),r}function x(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function f(t){let e=t,i=t;do{(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next}while(e!==t);return i}function y(t,e,i,s,r,n){const o=new Array;for(let r=0,a=s.length;r<a;r++){const h=c(t,e,0,s[r]*n,r<a-1?s[r+1]*n:i*n,n,!1);h===h.next&&(h.steiner=!0),o.push(f(h))}o.sort(S);for(const t of o)r=_(t,r);return r}function _(t,e){const i=function(t,e){let i=e;const s=t.x,r=t.y;let n,o=-1/0;do{if(r<=i.y&&r>=i.next.y&&i.next.y!==i.y){const t=i.x+(r-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(t<=s&&t>o){if(o=t,t===s){if(r===i.y)return i;if(r===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!n)return null;if(s===o)return n.prev;const a=n,c=n.x,h=n.y;let u,l=1/0;for(i=n.next;i!==a;)s>=i.x&&i.x>=c&&s!==i.x&&k(r<h?s:o,r,c,h,r<h?o:s,r,i.x,i.y)&&(u=Math.abs(r-i.y)/(s-i.x),(u<l||u===l&&i.x>n.x)&&v(i,t)&&(n=i,l=u)),i=i.next;return n}(t,e);if(!i)return e;const s=M(i,t);return h(s,s.next),h(i,i.next)}function m(t,e,i,s){let r;for(;r!==t;r=r.next){if(r=r||t,null===r.z&&(r.z=b(r.x,r.y,e,i,s)),r.prev.next!==r||r.next.prev!==r)return r.prev.next=r,r.next.prev=r,m(t,e,i,s);r.prevZ=r.prev,r.nextZ=r.next}return t.prevZ.nextZ=null,t.prevZ=null,function(t){let e,i=1;for(;;){let s,r=t;t=null,e=null;let n=0;for(;r;){n++,s=r;let o=0;for(;o<i&&s;o++)s=s.nextZ;let a=i;for(;o>0||a>0&&s;){let i;0===o?(i=s,s=s.nextZ,a--):0!==a&&s?r.z<=s.z?(i=r,r=r.nextZ,o--):(i=s,s=s.nextZ,a--):(i=r,r=r.nextZ,o--),e?e.nextZ=i:t=i,i.prevZ=e,e=i}r=s}if(e.nextZ=null,i*=2,n<2)return t}}(t)}function g(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function w(t,e,i,s){return!!(T(t,e)&&T(i,s)||T(t,s)&&T(i,e))||g(t,e,i)>0!=g(t,e,s)>0&&g(i,s,t)>0!=g(i,s,e)>0}function k(t,e,i,s,r,n,o,a){return(r-o)*(e-a)-(t-o)*(n-a)>=0&&(t-o)*(s-a)-(i-o)*(e-a)>=0&&(i-o)*(n-a)-(r-o)*(s-a)>=0}function v(t,e){return g(t.prev,t,t.next)<0?g(t,e,t.next)>=0&&g(t,t.prev,e)>=0:g(t,e,t.prev)<0||g(t,t.next,e)<0}function b(t,e,i,s,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-s)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function T(t,e){return t.x===e.x&&t.y===e.y}function S(t,e){return t.x-e.x}function P(t,e,i,s){let r=t;do{const n=r.prev,o=r.next.next;!T(n,o)&&w(n,r,r.next,o)&&v(n,o)&&v(o,n)&&(e.push(n.index/i+s),e.push(r.index/i+s),e.push(o.index/i+s),x(r),x(r.next),r=t=o),r=r.next}while(r!==t);return r}function E(t,e,i,s,r,n,o){let a=t;do{let t=a.next.next;for(;t!==a.prev;){if(a.index!==t.index&&z(a,t)){let c=M(a,t);return a=h(a,a.next),c=h(c,c.next),u(a,e,i,s,r,n,o,0),void u(c,e,i,s,r,n,o,0)}t=t.next}a=a.next}while(a!==t)}function z(t,e){return t.next.index!==e.index&&t.prev.index!==e.index&&!function(t,e){let i=t;do{if(i.index!==t.index&&i.next.index!==t.index&&i.index!==e.index&&i.next.index!==e.index&&w(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}(t,e)&&v(t,e)&&v(e,t)&&function(t,e){let i=t,s=!1;const r=(t.x+e.x)/2,n=(t.y+e.y)/2;do{i.y>n!=i.next.y>n&&i.next.y!==i.y&&r<(i.next.x-i.x)*(n-i.y)/(i.next.y-i.y)+i.x&&(s=!s),i=i.next}while(i!==t);return s}(t,e)}function M(t,e){const i=L.create(t.index,t.x,t.y),s=L.create(e.index,e.x,e.y),r=t.next,n=e.prev;return t.next=e,e.prev=t,i.next=r,r.prev=i,s.next=i,i.prev=s,n.next=s,s.prev=n,s}class L{constructor(){this.index=0,this.x=0,this.y=0,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}static create(t,e,i){const s=N<I.length?I[N++]:new L;return s.index=t,s.x=e,s.y=i,s.prev=null,s.next=null,s.z=null,s.prevZ=null,s.nextZ=null,s.steiner=!1,s}}const I=[];let N=0;for(let t=0;t<8096;t++)I.push(new L);const B=1e-5,A=new r.O3(0,0,0,1,0),R=new r.O3(0,0,0,1,0);function D(t,e,i){let s=0;for(let r=1;r<i;r++){const i=t[2*(e+r-1)],n=t[2*(e+r-1)+1];s+=(t[2*(e+r)]-i)*(t[2*(e+r)+1]+n)}return s}function Y(t,e,i,s,r){let n=0;for(let o=i;o<s;o+=3){const i=2*(t[o]-r),s=2*(t[o+1]-r),a=2*(t[o+2]-r);n+=Math.abs((e[i]-e[a])*(e[s+1]-e[i+1])-(e[i]-e[s])*(e[a+1]-e[i+1]))}return n}function V(t,e){const{coords:i,lengths:s,hasIndeterminateRingOrder:r}=e,n=t;if(r)return!1;let o=0;for(let t=0;t<s.length;){let e=t,r=s[t],c=D(i,o,r);const h=[];for(;++e<s.length;){const t=s[e],n=D(i,o+r,t);if(!(n>0))break;c+=n,h.push(o+r),r+=t}const u=n.length;a(n,i,o,o+r,h,2,0);const l=Y(n,i,u,n.length,0),p=Math.abs(c);if(Math.abs((l-p)/Math.max(1e-7,p))>B)return n.length=0,!1;t=e,o+=r}return!0}function F(t){const{coords:e,lengths:i}=t,{buffer:r}=(0,s.l)(e,i);return r}function O(t,e){if(null==t)return null;if(!function(t,e,i){let s=0;for(let r=0;r<t.lengths.length;r++){const n=t.lengths[r];for(let r=0;r<n;r++){const n=t.coords[2*(r+s)],o=t.coords[2*(r+s)+1];if(n<e||n>i||o<e||o>i)return!0}s+=n}return!1}(t,-128,o.CQ+128))return t;A.setPixelMargin(e),A.reset(r.dC.Polygon);let i=0;for(let e=0;e<t.lengths.length;e++){const s=t.lengths[e];let r=t.coords[2*(0+i)],n=t.coords[2*(0+i)+1];A.moveTo(r,n);for(let e=1;e<s;e++)r=t.coords[2*(e+i)],n=t.coords[2*(e+i)+1],A.lineTo(r,n);A.close(),i+=s}const s=A.result(!1);if(!s)return null;const a=[],c=[];for(const t of s){let e=0;for(const i of t)c.push(i.x),c.push(i.y),e++;a.push(e)}return new n.A(a,c)}function G(t,e){R.setPixelMargin(e);const i=R,s=-e,n=o.CQ+e;let a=[],c=!1;if(!t.nextPath())return null;let h=!0;for(;h;){t.seekPathStart();const e=[];if(!t.pathSize)return null;i.reset(r.dC.LineString),t.nextPoint();let o=t.x,u=t.y;if(c)i.moveTo(o,u);else{if(o<s||o>n||u<s||u>n){c=!0;continue}e.push({x:o,y:u})}let l=!1;for(;t.nextPoint();)if(o=t.x,u=t.y,c)i.lineTo(o,u);else{if(o<s||o>n||u<s||u>n){l=!0;break}e.push({x:o,y:u})}if(l)c=!0;else{if(c){const t=i.resultWithStarts();if(t)for(const e of t)a.push(e)}else a.push({line:e,start:0});h=t.nextPath(),c=!1}}return a=a.filter((t=>t.line.length>1)),0===a.length?null:a}A.setExtent(o.CQ),R.setExtent(o.CQ)},47819:(t,e,i)=>{i.d(e,{k:()=>o});var s=i(58082),r=i(68716);const n={createComputedParams:t=>t,optionalAttributes:{},attributes:{id:{type:r.pe.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:r.pe.UNSIGNED_BYTE,count:1},pos:{type:r.pe.SHORT,count:2,pack:"position",packPrecisionFactor:10},inverseArea:{type:r.pe.FLOAT,count:1,packTessellation:({inverseArea:t})=>t}}};class o extends s.N{constructor(){super(...arguments),this.vertexSpec=n}createTesselationParams(t){return{inverseArea:1/t.readGeometryArea()}}}},58082:(t,e,i)=>{i.d(e,{N:()=>c});var s=i(6273),r=i(20472),n=i(93548),o=i(97933);const a=(0,s.A)("featurelayer-fast-triangulation-enabled");class c extends o.r{async loadDependencies(){await Promise.all([super.loadDependencies(),(0,r.F)()])}_write(t,e,i){const s=i?.asOptimized()??e.readGeometryForDisplay(),r=this._clip(s);r&&(t.recordStart(this.instanceId,this.attributeLayout),this._writeGeometry(t,e,r),t.recordEnd())}_clip(t){if(!t)return null;const e=this.hasEffects;return(0,n.FE)(t,e?256:8)}_writeGeometry(t,e,i){const s=i.maxLength>100,r=[],o=this.createTesselationParams(e);if(!s&&a&&(0,n.lO)(r,i))return void(r.length&&this._writeVertices(t,e,i.coords,o,r));const c=(0,n.XZ)(i);this._writeVertices(t,e,c,o)}_writeVertices(t,e,i,s,r){const n=e.getDisplayId(),o=t.vertexCount(),a=this.hasEffects;let c=0;if(r)for(const e of r){const r=i[2*e],o=i[2*e+1];a&&t.recordBounds(r,o,0,0),this._writeVertex(t,n,r,o,s),c++}else for(let e=0;e<i.length;e+=2){const r=Math.round(i[e]),o=Math.round(i[e+1]);a&&t.recordBounds(r,o,0,0),this._writeVertex(t,n,r,o,s),c++}t.indexEnsureSize(c);for(let e=0;e<c;e++)t.indexWrite(e+o)}}},39313:(t,e,i)=>{i.d(e,{KE:()=>p,KI:()=>u,lB:()=>l,oI:()=>h});var s=i(23572),r=i(40396),n=i(51917),o=i(36123),a=i(77330),c=i(68716);function h(t){const{sprite:e,aspectRatio:i,scaleProportionally:r}=t,n=(0,s.Lz)(t.height),o=n>0?n:e.height;let a=n*i;return a<=0?a=e.width:r&&(a*=e.width/e.height),{width:a,height:o}}function u(t){const{applyRandomOffset:e,sampleAlphaOnly:i}=t;return(0,n.xo)([[a.Fz,e],[a.cn,i]])}const l={createComputedParams:t=>t,optionalAttributes:o.l.optionalAttributes,attributes:{...o.l.attributes,bitset:{count:1,type:c.pe.UNSIGNED_BYTE,pack:u},width:{count:1,type:c.pe.HALF_FLOAT,pack:t=>h(t).width},height:{count:1,type:c.pe.HALF_FLOAT,pack:t=>h(t).height},offset:{count:2,type:c.pe.HALF_FLOAT,pack:({offsetX:t,offsetY:e})=>[(0,s.Lz)(t),-(0,s.Lz)(e)]},scale:{count:2,type:c.pe.UNSIGNED_BYTE,packPrecisionFactor:16,pack:({scaleX:t,scaleY:e})=>[t,e]},angle:{count:1,type:c.pe.UNSIGNED_BYTE,pack:({angle:t})=>(0,r.wV)(t)}}};class p extends o.m{constructor(){super(...arguments),this.vertexSpec=l}}},64329:(t,e,i)=>{i.d(e,{O:()=>y});var s=i(23572),r=i(52266),n=i(39313),o=i(51917),a=i(90927),c=i(86049),h=i(77330),u=i(68716);const l=n.lB,p=a.e4,d={createComputedParams:t=>t,optionalAttributes:l.optionalAttributes,attributes:{...l.attributes,bitset:{type:u.pe.UNSIGNED_BYTE,count:1,pack:t=>(0,n.KI)(t)},aux1:{count:1,type:u.pe.HALF_FLOAT,pack:t=>(0,n.oI)(t).width},aux2:{count:1,type:u.pe.HALF_FLOAT,pack:t=>(0,n.oI)(t).height},aux3:{count:2,type:u.pe.HALF_FLOAT,pack:({offsetX:t,offsetY:e})=>[(0,s.Lz)(t),(0,s.Lz)(e)]},aux4:{count:2,type:u.pe.UNSIGNED_BYTE,pack:({scaleX:t,scaleY:e})=>[t*c.cZ,e*c.cZ]}}},x={createComputedParams:t=>t,optionalAttributes:l.optionalAttributes,attributes:{...l.attributes,color:p.attributes.color,bitset:{type:u.pe.UNSIGNED_BYTE,count:1,pack:t=>(0,o.xo)([[h.Xx,!0]])},aux1:{count:1,type:u.pe.HALF_FLOAT,pack:t=>(0,s.Lz)(.5*t.width)},aux2:{count:1,type:u.pe.HALF_FLOAT,pack:t=>(0,s.Lz)(.5*t.referenceWidth)},aux3:{count:2,type:u.pe.HALF_FLOAT,packTessellation:({extrusionOffsetX:t,extrusionOffsetY:e})=>[t,e]},aux4:{count:2,type:u.pe.UNSIGNED_BYTE,packTessellation:({normalX:t,normalY:e})=>[t*c.cZ+c.v9,e*c.cZ+c.v9]}}};class f extends a.eY{constructor(){super(...arguments),this.vertexSpec=x}}class y extends a.w0{constructor(){super(...arguments),this.vertexSpec=d}_createOutlineWriter(t,e,i,s){return new f(t,e,i,s)}_write(t,e,i){const s=i?.asOptimized()??e.readGeometryForDisplay(),n=this._clip(s);if(!n)return;const o=this.evaluatedMeshParams.sprite?.textureBinding;t.recordStart(this.instanceId,this.attributeLayout,o),this._writeGeometry(t,e,n),this._lineMeshWriter.writeLineVertices(t,r.z.fromOptimizedCIM(n,"esriGeometryPolyline"),e),t.recordEnd()}ensurePacked(t,e,i){super.ensurePacked(t,e,i),this._lineMeshWriter.ensurePacked(t,e,i)}enqueueRequest(t,e,i){super.enqueueRequest(t,e,i),this._lineMeshWriter.enqueueRequest(t,e,i)}async loadDependencies(){await Promise.all([super.loadDependencies(),this._lineMeshWriter.loadDependencies()])}}},5467:(t,e,i)=>{i.d(e,{Y:()=>c,v:()=>a});var s=i(6538),r=i(58082),n=i(51917),o=i(68716);const a={createComputedParams:t=>t,optionalAttributes:{zoomRange:{type:o.pe.SHORT,count:2,packPrecisionFactor:s.fq,pack:({scaleInfo:t},{tileInfo:e})=>(0,n.My)(t,e)}},attributes:{id:{type:o.pe.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:o.pe.UNSIGNED_BYTE,count:1},pos:{type:o.pe.SHORT,count:2,pack:"position",packPrecisionFactor:10},color:{type:o.pe.UNSIGNED_BYTE,count:4,normalized:!0,pack:({color:t})=>(0,n.Jb)(t)}}};class c extends r.N{constructor(){super(...arguments),this.vertexSpec=a}createTesselationParams(t){return null}}},90927:(t,e,i)=>{i.d(e,{Lm:()=>l,e4:()=>p,eY:()=>d,w0:()=>x});var s=i(52266),r=i(93548),n=i(5467),o=i(51917),a=i(98721),c=i(43135),h=i(77330),u=i(68716);const l={createComputedParams:t=>t,optionalAttributes:a.Eq.optionalAttributes,attributes:{...a.Eq.attributes,bitset:{type:u.pe.UNSIGNED_BYTE,count:1,pack:t=>0},color:{type:u.pe.UNSIGNED_BYTE,count:4,normalized:!0,pack:({color:t})=>(0,o.Jb)(t)}}},p={createComputedParams:t=>t,optionalAttributes:a.Eq.optionalAttributes,attributes:{...a.Eq.attributes,bitset:{type:u.pe.UNSIGNED_BYTE,count:1,pack:t=>(0,o.xo)([[h.Xx,!0]])},color:{type:u.pe.UNSIGNED_BYTE,count:4,normalized:!0,pack:({outlineColor:t})=>(0,o.Jb)(t)}}};class d extends a.Bw{constructor(){super(...arguments),this.vertexSpec=p}}class x extends n.Y{constructor(t,e,i,s){super(t,e,i,s),this.vertexSpec=l,this._lineMeshWriter=this._createOutlineWriter(t,e,i,s)}_createOutlineWriter(t,e,i,s){return new d(t,e,i,s)}_write(t,e,i){const r=i?.asOptimized()??e.readGeometryForDisplay(),n=this._clip(r);n&&(t.recordStart(this.instanceId,this.attributeLayout),this._writeGeometry(t,e,n),this._lineMeshWriter.writeLineVertices(t,s.z.fromOptimizedCIM(n,"esriGeometryPolyline"),e),t.recordEnd())}_clip(t){return t?(0,r.FE)(t,(0,c.Z0)(this.evaluatedMeshParams)):null}ensurePacked(t,e,i){super.ensurePacked(t,e,i),this._lineMeshWriter.ensurePacked(t,e,i)}enqueueRequest(t,e,i){super.enqueueRequest(t,e,i),this._lineMeshWriter.enqueueRequest(t,e,i)}async loadDependencies(){await Promise.all([super.loadDependencies(),this._lineMeshWriter.loadDependencies()])}}},36123:(t,e,i)=>{i.d(e,{l:()=>o,m:()=>a});var s=i(6538),r=i(5467),n=i(68716);const o={createComputedParams:t=>t,optionalAttributes:r.v.optionalAttributes,attributes:{...r.v.attributes,tlbr:{count:4,type:n.pe.UNSIGNED_SHORT,pack:({sprite:t})=>{const{rect:e,width:i,height:r}=t,n=e.x+s.hM,o=e.y+s.hM;return[n,o,n+i,o+r]}},inverseRasterizationScale:{count:1,type:n.pe.BYTE,packPrecisionFactor:16,pack:({sprite:t})=>1/t.rasterizationScale}}};class a extends r.Y{constructor(){super(...arguments),this.vertexSpec=o}_write(t,e,i){const s=i?.asOptimized()??e.readGeometryForDisplay(),r=this._clip(s);if(!r)return;const n=this.evaluatedMeshParams.sprite?.textureBinding;t.recordStart(this.instanceId,this.attributeLayout,n),this._writeGeometry(t,e,r),t.recordEnd()}}},23695:(t,e,i)=>{i.d(e,{Q:()=>h});var s=i(52266),r=i(90927),n=i(36123);const o={optionalAttributes:n.l.optionalAttributes,createComputedParams:t=>t,attributes:{...n.l.attributes,...r.Lm.attributes}},a={optionalAttributes:n.l.optionalAttributes,createComputedParams:t=>t,attributes:{...n.l.attributes,...r.e4.attributes}};class c extends r.eY{constructor(){super(...arguments),this.vertexSpec=a}}class h extends r.w0{constructor(){super(...arguments),this.vertexSpec=o}_createOutlineWriter(t,e,i,s){return new c(t,e,i,s)}_write(t,e,i){const r=i?.asOptimized()??e.readGeometryForDisplay(),n=this._clip(r);if(!n)return;const o=this.evaluatedMeshParams.sprite?.textureBinding;t.recordStart(this.instanceId,this.attributeLayout,o),this._writeGeometry(t,e,n),this._lineMeshWriter.writeLineVertices(t,s.z.fromOptimizedCIM(n,"esriGeometryPolyline"),e),t.recordEnd()}ensurePacked(t,e,i){super.ensurePacked(t,e,i),this._lineMeshWriter.ensurePacked(t,e,i)}enqueueRequest(t,e,i){super.enqueueRequest(t,e,i),this._lineMeshWriter.enqueueRequest(t,e,i)}async loadDependencies(){await Promise.all([super.loadDependencies(),this._lineMeshWriter.loadDependencies()])}}},51917:(t,e,i)=>{i.d(e,{By:()=>_,Jb:()=>d,My:()=>u,i8:()=>y,mR:()=>l,qE:()=>f,ue:()=>x,xo:()=>p});var s=i(93814),r=i(62991),n=i(80861),o=i(85953);const a=()=>n.A.getLogger("esri.views.2d.engine.webgl.shaderGraph.techniques.meshWriterUtils"),c=0,h=100;function u(t,e){return[!!t?.minScale&&e.scaleToZoom(t.minScale)||c,!!t?.maxScale&&e.scaleToZoom(t.maxScale)||h]}function l(t){return 1<<t}function p(t){let e=0;for(const[i,s]of t)s&&(e|=1<<i);return e}function d(t){let e;if(!t)return[0,0,0,0];if("string"==typeof t){const i=s.A.fromString(t);if(!i)return a().errorOnce(new r.A("mapview:mesh-processing","Unable to parse string into color",{color:t})),[0,0,0,0];e=i.toArray()}else e=t;const[i,n,o,c]=e;return[i*(c/255),n*(c/255),o*(c/255),c]}function x(t){switch(t){case"butt":case o.uT.Butt:return o.xR.BUTT;case"round":case o.uT.Round:return o.xR.ROUND;case"square":case o.uT.Square:return o.xR.SQUARE}}function f(t){switch(t){case"bevel":case o.wd.Bevel:return o.JO.BEVEL;case"miter":case o.wd.Miter:return o.JO.MITER;case"round":case o.wd.Round:return o.JO.ROUND}}function y(t,e){return Math.round(Math.min(Math.sqrt(t*e),255))}function _(t,e){return Math.round(t*e)/e}},20059:(t,e,i)=>{i.d(e,{h:()=>o});var s=i(97933),r=i(68716);const n={createComputedParams:t=>t,optionalAttributes:{},attributes:{pos:{type:r.pe.SHORT,count:2,pack:"position",packPrecisionFactor:10},id:{type:r.pe.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:r.pe.UNSIGNED_BYTE,count:1},offset:{type:r.pe.BYTE,count:2,packAlternating:{count:4,pack:()=>[[-1,-1],[1,-1],[-1,1],[1,1]]}}}};class o extends s.r{constructor(){super(...arguments),this.vertexSpec=n}_write(t,e){t.recordStart(this.instanceId,this.attributeLayout);const i=e.getDisplayId();if("esriGeometryPoint"===e.geometryType){const s=e.readXForDisplay(),r=e.readYForDisplay();this._writeQuad(t,i,s,r)}else if("esriGeometryMultipoint"===e.geometryType){const s=e.readGeometryForDisplay();s?.forEachVertex(((e,s)=>{e>=0&&e<=512&&s>=0&&s<=512&&this._writeQuad(t,i,e,s)}))}t.recordEnd()}_writeQuad(t,e,i,s){const r=t.vertexCount();this._writeVertex(t,e,i,s),t.indexWrite(r+0),t.indexWrite(r+1),t.indexWrite(r+2),t.indexWrite(r+1),t.indexWrite(r+3),t.indexWrite(r+2)}}},98721:(t,e,i)=>{i.d(e,{Bw:()=>f,Eq:()=>d});var s=i(23572),r=i(52266),n=i(6538),o=i(73274),a=i(93548),c=i(51917),h=i(97933),u=i(43135),l=i(68716);class p{constructor(){this.extrusionOffsetX=0,this.extrusionOffsetY=0,this.normalX=0,this.normalY=0,this.directionX=0,this.directionY=0,this.distance=0}}const d={createComputedParams:t=>t,optionalAttributes:{zoomRange:{type:l.pe.SHORT,count:2,packPrecisionFactor:n.fq,pack:({scaleInfo:t},{tileInfo:e})=>(0,c.My)(t,e)}},attributes:{id:{type:l.pe.UNSIGNED_BYTE,count:3,pack:"id"},pos:{type:l.pe.SHORT,count:2,pack:"position",packPrecisionFactor:10},bitset:{type:l.pe.UNSIGNED_BYTE,count:1},color:{type:l.pe.UNSIGNED_BYTE,count:4,normalized:!0,pack:({color:t})=>(0,c.Jb)(t)},offset:{type:l.pe.BYTE,count:2,packPrecisionFactor:16,packTessellation:({extrusionOffsetX:t,extrusionOffsetY:e})=>[(0,c.By)(t,16),(0,c.By)(e,16)]},normal:{type:l.pe.BYTE,count:2,packPrecisionFactor:16,packTessellation:({normalX:t,normalY:e})=>[(0,c.By)(t,16),(0,c.By)(e,16)]},halfWidth:{type:l.pe.HALF_FLOAT,count:1,pack:({width:t})=>(0,s.Lz)(.5*t)},referenceHalfWidth:{type:l.pe.HALF_FLOAT,count:1,pack:({referenceWidth:t})=>(0,s.Lz)(.5*t)}}};class x{constructor(){this.id=0,this.bitset=0,this.indexCount=0,this.vertexCount=0,this.vertexFrom=0,this.vertexBounds=0}}class f extends h.r{constructor(t,e,i,s){super(t,e,i,s),this.vertexSpec=d,this._currentWrite=new x,this._tessellationOptions={halfWidth:0,pixelCoordRatio:1,offset:0,wrapDistance:65535,textured:!1},this._tessParams=new p,this._initializeTessellator()}writeLineVertices(t,e,i){const s=this._getLines(e);null!=s&&this._writeVertices(t,i,s)}_initializeTessellator(){this._lineTessellator=new o.i(this._writeTesselatedVertex.bind(this),this._writeTriangle.bind(this),!0)}_write(t,e,i){const s=i??r.z.fromFeatureSetReaderCIM(e);s&&this._writeGeometry(t,e,s)}_writeGeometry(t,e,i,s){t.recordStart(this.instanceId,this.attributeLayout,s),this.writeLineVertices(t,i,e),t.recordEnd()}_getLines(t){return(0,a.uS)(t,(0,u.Z0)(this.evaluatedMeshParams))}_writeVertices(t,e,i){const{_currentWrite:r,_tessellationOptions:o,evaluatedMeshParams:a}=this,{width:h,capType:u,joinType:l,miterLimit:p,hasSizeVV:d}=a,x=(0,s.Lz)(.5*h);o.halfWidth=x,o.capType=(0,c.ue)(u),o.joinType=(0,c.qE)(l),o.miterLimit=p;const f=!d;r.out=t,r.id=e.getDisplayId(),r.vertexCount=0,r.indexCount=0,r.vertexFrom=t.vertexCount(),r.vertexBounds=f&&x<n.Gh?0:1;for(const{line:t,start:e}of i)o.initialDistance=e%65535,this._lineTessellator.tessellate(t,o,f)}_writeTesselatedVertex(t,e,i,s,r,n,o,a,c,h,u){const{out:l,id:p,vertexBounds:d}=this._currentWrite;return this.hasEffects&&l.recordBounds(t,e,d,d),this._tessParams.extrusionOffsetX=o,this._tessParams.extrusionOffsetY=a,this._tessParams.normalX=c,this._tessParams.normalY=h,this._tessParams.directionX=r,this._tessParams.directionY=n,this._tessParams.distance=u,this._writeVertex(l,p,t,e,this._tessParams),this._currentWrite.vertexFrom+this._currentWrite.vertexCount++}_writeTriangle(t,e,i){const{out:s}=this._currentWrite;s.indexEnsureSize(3),s.indexWrite(t),s.indexWrite(e),s.indexWrite(i),this._currentWrite.indexCount+=3}}},43208:(t,e,i)=>{i.d(e,{K:()=>u});var s=i(52266),r=i(6538),n=i(51917),o=i(98721),a=i(77330),c=i(68716);const h={createComputedParams:t=>t,optionalAttributes:o.Eq.optionalAttributes,attributes:{...o.Eq.attributes,bitset:{type:c.pe.UNSIGNED_BYTE,count:1,pack:({shouldSampleAlphaOnly:t,shouldScaleDash:e,isSDF:i})=>(0,n.xo)([[a.cn,t],[a.kx,e],[a.b5,i]])},tlbr:{type:c.pe.UNSIGNED_SHORT,count:4,pack:({sprite:t})=>{const{rect:e,width:i,height:s}=t,n=e.x+r.hM,o=e.y+r.hM;return[n,o,n+i,o+s]}},accumulatedDistance:{type:c.pe.UNSIGNED_SHORT,count:1,packTessellation:({distance:t})=>t},segmentDirection:{type:c.pe.BYTE,count:2,packPrecisionFactor:16,packTessellation:({directionX:t,directionY:e})=>[t,e]}}};class u extends o.Bw{constructor(t,e,i,s){super(t,e,i,s),this.vertexSpec=h,this._tessellationOptions.textured=!0}_write(t,e,i){const r=i??s.z.fromFeatureSetReaderCIM(e);if(!r)return;const{sprite:n}=this.evaluatedMeshParams;this._writeGeometry(t,e,r,n?.textureBinding)}}},22956:(t,e,i)=>{i.d(e,{H:()=>v});var s=i(23572),r=i(94464),n=i(68749),o=i(53334),a=i(52266),c=i(61866),h=i(85953),u=i(91954),l=i(6538),p=i(51917),d=i(77234);class x{static from(t){return"width"in t?this.fromSimpleMeshParams(t):this.fromComplexMeshParams(t)}static fromSimpleMeshParams(t){const e=new x(t.sprite,t.color,t.outlineColor,t.minPixelBuffer,t.placement,t.scaleInfo,t.effects),{type:i,width:r,height:n,angle:o,alignment:a,outlineSize:c,referenceSize:h,sprite:u,overrideOutlineColor:l}=t;e.rawWidth=(0,s.Lz)(r),e.rawHeight=(0,s.Lz)(n),e.angle=o,e.alignment=a,e.outlineSize=(0,s.Lz)(c),e.referenceSize=(0,s.Lz)(h),e.overrideOutlineColor=l,e.offsetX=(0,s.Lz)(t.offsetX),e.offsetY=(0,s.Lz)(t.offsetY),"simple"!==i||u.sdf||(e.rawWidth=u.width,e.rawHeight=u.height);return e.sizeRatio=u.sdf?2:1,e._computeSize(t,!1),e}static fromComplexMeshParams(t){const e=new x(t.sprite,t.color,t.outlineColor,t.minPixelBuffer,t.placement,t.scaleInfo,t.effects);let{alignment:i,transforms:r,size:n,scaleX:o,anchorX:a,anchorY:c,angle:h,colorLocked:u,frameHeight:l,widthRatio:p,offsetX:f,offsetY:y,outlineSize:_,referenceSize:m,scaleFactor:g,sizeRatio:w,isAbsoluteAnchorPoint:k,rotateClockwise:v,scaleSymbolsProportionally:b,sprite:T}=t;if(r&&r.infos.length>0){const t=(0,d.zb)(n,h,v,f,y,r);n=t.size,h=t.rotation,f=t.offsetX,y=t.offsetY,v=!1}g&&(n*=g,f*=g,y*=g);const S=o*(T.width/T.height);e.alignment=i,e.rawHeight=(0,s.Lz)(n),e.rawWidth=e.rawHeight*S,e.referenceSize=(0,s.Lz)(m),e.sizeRatio=w,e.angle=h,e.rotateClockwise=v,e.anchorX=a,e.anchorY=c,e.offsetX=(0,s.Lz)(f),e.offsetY=(0,s.Lz)(y),k&&n&&(T.sdf?e.anchorX=a/(n*p):e.anchorX=a/(n*S),e.anchorY=c/n);const P=b&&l?n/l:1;return e.outlineSize=0===_||isNaN(_)?0:(0,s.Lz)(_)*P,e.scaleSymbolsProportionally=b,e.colorLocked=u,e._computeSize(t,!0),e}constructor(t,e,i,s,r,n,o){this.sprite=t,this.color=e,this.outlineColor=i,this.minPixelBuffer=s,this.placement=r,this.scaleInfo=n,this.effects=o,this.rawWidth=0,this.rawHeight=0,this.angle=0,this.outlineSize=0,this.referenceSize=0,this.sizeRatio=1,this.alignment=h.C1.SCREEN,this.scaleSymbolsProportionally=!1,this.overrideOutlineColor=!1,this.colorLocked=!1,this.anchorX=0,this.anchorY=0,this.computedWidth=0,this.computedHeight=0,this.texXmin=0,this.texYmin=0,this.texXmax=0,this.texYmax=0,this.offsetX=0,this.offsetY=0,this.rotateClockwise=!0}get boundsInfo(){return{size:Math.max(this.computedHeight,this.computedWidth),offsetX:this.offsetX,offsetY:this.offsetY}}_computeSize(t,e){const{sprite:i,hasSizeVV:s}=t,r=!!i.sdf,{rawWidth:n,rawHeight:o,sizeRatio:a,outlineSize:c}=this,h=n*a,u=o*a;if(r&&!s){const t=e&&n>o?h:n,i=o,s=c+2;this.computedWidth=Math.min(t+s,h),this.computedHeight=Math.min(i+s,u)}else this.computedWidth=h,this.computedHeight=u;const p=r?Math.max(i.width,i.height)/Math.max(h,u):1,d=.5*(h-this.computedWidth)*p,x=.5*(u-this.computedHeight)*p,f=i.rect.x+l.hM+d,y=i.rect.y+l.hM+x,_=f+i.width-2*d,m=y+i.height-2*x;this.texXmin=Math.floor(f),this.texYmin=Math.floor(y),this.texXmax=Math.ceil(_),this.texYmax=Math.ceil(m),this.computedWidth*=(this.texXmax-this.texXmin)/(_-f),this.computedHeight*=(this.texYmax-this.texYmin)/(m-y),this.anchorX*=h/this.computedWidth,this.anchorY*=u/this.computedHeight}}var f=i(49093),y=i(43442),_=i(97933),m=i(68716);const g=128/Math.PI;function w(t){return function(t,e){return t%=e,Math.abs(t>=0?t:t+e)}(t*g,256)}const k={createComputedParams:t=>x.from(t),optionalAttributes:{zoomRange:{type:m.pe.SHORT,count:2,packPrecisionFactor:l.fq,pack:({scaleInfo:t},{tileInfo:e})=>(0,p.My)(t,e)}},attributes:{pos:{type:m.pe.SHORT,count:2,pack:"position",packPrecisionFactor:10},id:{type:m.pe.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:m.pe.UNSIGNED_BYTE,count:1,pack:({sprite:t,alignment:e,scaleSymbolsProportionally:i,overrideOutlineColor:s,colorLocked:r})=>{let n=0;return t.sdf&&(n|=(0,p.mR)(f.c.bitset.isSDF)),e===h.C1.MAP&&(n|=(0,p.mR)(f.c.bitset.isMapAligned)),i&&(n|=(0,p.mR)(f.c.bitset.scaleSymbolsProportionally)),s&&(n|=(0,p.mR)(f.c.bitset.overrideOutlineColor)),r&&(n|=(0,p.mR)(f.c.bitset.colorLocked)),n}},offset:{type:m.pe.SHORT,count:2,packPrecisionFactor:4,packAlternating:{count:4,pack:({angle:t,computedWidth:e,computedHeight:i,anchorX:s,anchorY:a,offsetX:c,offsetY:h,rotateClockwise:u})=>{const l=function(t,e,i,s,o=!1){const a=(0,n.vt)(),c=o?1:-1;return(0,r.D_)(a),(e||i)&&(0,r.Tl)(a,a,[e,-i]),s&&(0,r.e$)(a,a,.017453292519944444*c*-s),a}(0,c,h,-t,u),p=-(.5+s)*e,d=-(.5-a)*i,x=[p,d],f=[p+e,d],y=[p,d+i],_=[p+e,d+i];return(0,o.l0)(x,x,l),(0,o.l0)(f,f,l),(0,o.l0)(y,y,l),(0,o.l0)(_,_,l),[x,f,y,_]}}},textureUV:{type:m.pe.SHORT,count:2,packPrecisionFactor:4,packAlternating:{count:4,pack:({texXmax:t,texXmin:e,texYmax:i,texYmin:s})=>[[e,s],[t,s],[e,i],[t,i]]}},color:{type:m.pe.UNSIGNED_BYTE,count:4,normalized:!0,pack:({color:t})=>(0,p.Jb)(t)},outlineColor:{type:m.pe.UNSIGNED_BYTE,count:4,normalized:!0,pack:({outlineColor:t})=>(0,p.Jb)(t)},sizing:{type:m.pe.UNSIGNED_BYTE,count:4,pack:({rawWidth:t,rawHeight:e,outlineSize:i,referenceSize:s})=>{const r=Math.max(t,e);return[(0,p.i8)(r,128),(0,p.i8)(i,128),(0,p.i8)(s,128),0]}},placementAngle:{type:m.pe.UNSIGNED_BYTE,count:1,packTessellation:({placementAngle:t})=>w(t)},sizeRatio:{type:m.pe.UNSIGNED_SHORT,count:1,packPrecisionFactor:64,pack:({sizeRatio:t})=>t}}};class v extends _.r{constructor(){super(...arguments),this.vertexSpec=k}getBoundsInfo(){return this.evaluatedMeshParams.boundsInfo}_write(t,e,i){const s=this.evaluatedMeshParams.sprite?.textureBinding,r=e.getDisplayId();t.recordStart(this.instanceId,this.attributeLayout,s);const n=this.evaluatedMeshParams.minPixelBuffer,o=Math.max(this.evaluatedMeshParams.computedWidth,n),a=Math.max(this.evaluatedMeshParams.computedHeight,n),h=this.evaluatedMeshParams.offsetX,u=-this.evaluatedMeshParams.offsetY;if(null!=this.evaluatedMeshParams.placement)this._writePlacedMarkers(t,e,i,o,a);else if(i?.nextPath()){i.nextPoint();const e=i.x,s=i.y;t.recordBounds(e+h,s+u,o,a),this._writeQuad(t,r,e,s)}else if("esriGeometryPolygon"===e.geometryType){const i=e.readCentroidForDisplay();if(!i)return;const[s,n]=i.coords;t.recordBounds(s+h,n+u,o,a),this._writeQuad(t,r,s,n)}else if("esriGeometryPoint"===e.geometryType){const i=e.readXForDisplay(),s=e.readYForDisplay();t.recordBounds(i+h,s+u,o,a),this._writeQuad(t,r,i,s)}else{const i=e.readGeometryForDisplay();i?.forEachVertex(((e,i)=>{t.recordBounds(e+h,i+u,o,a),Math.abs(e)>c.s||Math.abs(i)>c.s||this._writeQuad(t,r,e,i)}))}t.recordEnd()}_writePlacedMarkers(t,e,i,r,n){const o=i??a.z.fromFeatureSetReaderCIM(e)?.clone();if(!o)return;const h=u.l.getPlacement(o,-1,this.evaluatedMeshParams.placement,(0,s.Lz)(1),t.id,(0,y.z)());if(!h)return;const l=e.getDisplayId();let p=h.next();const d=this.evaluatedMeshParams.offsetX,x=-this.evaluatedMeshParams.offsetY;for(;null!=p;){const e=p.tx,i=-p.ty;if(Math.abs(e)>c.s||Math.abs(i)>c.s){p=h.next();continue}const s=-p.getAngle();t.recordBounds(e+d,i+x,r,n),this._writeQuad(t,l,e,i,s),p=h.next()}}_writeQuad(t,e,i,s,r){const n=t.vertexCount(),o=null==r?null:{placementAngle:r};this._writeVertex(t,e,i,s,o),t.indexWrite(n+0),t.indexWrite(n+1),t.indexWrite(n+2),t.indexWrite(n+1),t.indexWrite(n+3),t.indexWrite(n+2)}}},97933:(t,e,i)=>{i.d(e,{r:()=>d});var s=i(52266),r=i(92524),n=i(43442),o=i(93911),a=(i(6273),i(43135)),c=i(68716);function h(t){switch(t){case c.pe.BYTE:case c.pe.UNSIGNED_BYTE:return 1;case c.pe.SHORT:case c.pe.UNSIGNED_SHORT:case c.pe.HALF_FLOAT:return 2;case c.pe.FLOAT:case c.pe.INT:case c.pe.UNSIGNED_INT:return 4}}class u{static fromVertexSpec(t,e){const{attributes:i,optionalAttributes:s}=t;let r,n,o;const a=[];for(const t in i){const e=i[t];"position"===e.pack?r={...e,name:t,offset:0}:"id"===e.pack?n={...e,name:t,offset:4}:"bitset"===t?o={...e,name:t,offset:7}:a.push({...e,name:t})}for(const t in s)if(!0===e[t]){const e=s[t];a.push({...e,name:t})}const c=function(t){const e=[],i=[],s=[];for(const r of t){const t=h(r.type)*r.count;switch(t%2||t%4||4){case 4:e.push(r);continue;case 2:i.push(r);continue;case 1:s.push(r);continue;default:throw new Error("Found unexpected dataType byte count")}}return e.push(...i),e.push(...s),e}(a),l=[];let p=8,d=1;for(const t of c)l.push({...t,offset:p}),p+=h(t.type)*t.count,t.packAlternating&&(d=Math.max(t.packAlternating.count,d));const x=Uint32Array.BYTES_PER_ELEMENT,f=p%x;return new u(r,n,o,l,p+(f?x-f:0),d)}constructor(t,e,i,s,r,n){this.position=t,this.id=e,this.bitset=i,this.standardAttributes=s,this.stride=r,this.packVertexCount=n,s.push(i),this._attributes=[t,e,i,...s]}get attributeLayout(){if(!this._attributeLayout){const t=(0,a.hU)(this._attributes),e=this._attributes.map((t=>({name:t.name,count:t.count,offset:t.offset,type:t.type,packPrecisionFactor:t.packPrecisionFactor,normalized:t.normalized??!1})));this._attributeLayout={attributes:e,hash:t,stride:this.stride}}return this._attributeLayout}}var l=i(30188);class p{static fromVertexSpec(t,e){const i=u.fromVertexSpec(t,e);return new p(i)}constructor(t){this._spec=t,this._packed=new Uint8Array(this._spec.stride*this._spec.packVertexCount),this._packedU32View=new Uint32Array(this._packed.buffer),this._dataView=new DataView(this._packed.buffer)}get attributeLayout(){return this._spec.attributeLayout}get stride(){return this._spec.stride}writeVertex(t,e,i,s,r,n){for(let t=0;t<this._spec.packVertexCount;t++){const o=t*this._spec.stride;this._packPosition(i,s,o),this._packId(e,o);const a=this._spec.bitset;if(n){if(a.packTessellation){const t=a.packTessellation(n,r);this._pack(t,a,o)}for(const t of this._spec.standardAttributes)if(null!=t.packTessellation){const e=t.packTessellation(n,r);this._pack(e,t,o)}else if(t.packAlternating?.packTessellation){const e=t.packAlternating.packTessellation(n,r);for(let i=0;i<this._spec.packVertexCount;i++){const s=e[i];this._pack(s,t,i*this._spec.stride)}}}}t.vertexWriteRegion(this._packedU32View)}pack(t,e){for(const i of this._spec.standardAttributes)if(i.pack&&"string"!=typeof i.pack){const s=i.pack(t,e);for(let t=0;t<this._spec.packVertexCount;t++)this._pack(s,i,t*this._spec.stride)}else if(i.packAlternating?.pack){const s=i.packAlternating.pack(t,e);for(let t=0;t<this._spec.packVertexCount;t++){const e=s[t];this._pack(e,i,t*this._spec.stride)}}}_packPosition(t,e,i){const{offset:s}=this._spec.position,r=this._spec.position.packPrecisionFactor??1,n=(0,o.M9)(t*r,e*r);this._dataView.setUint32(i+s,n,!0)}_packId(t,e){const i=t*(this._spec.id.packPrecisionFactor??1),s=4278190080&this._dataView.getUint32(e+this._spec.id.offset,!0);this._dataView.setUint32(e+this._spec.id.offset,i|s,!0)}_pack(t,e,i){(0,l.F)(this._dataView,t,e,i)}}class d{constructor(t,e,i,s){this._instanceId=t,this._evaluator=e,this._enabledOptionalAttributes=i,this._viewParams=s,this._evaluator.evaluator=t=>this.vertexSpec.createComputedParams(t)}get _vertexPack(){if(!this._cachedVertexPack){const t=p.fromVertexSpec(this.vertexSpec,this._enabledOptionalAttributes);this._evaluator.hasDynamicProperties||t.pack(this._evaluator.evaluatedMeshParams,this._viewParams),this._cachedVertexPack=t}return this._cachedVertexPack}get evaluatedMeshParams(){return this._evaluator.evaluatedMeshParams}get hasEffects(){return!!this.evaluatedMeshParams.effects}get instanceId(){return this._instanceId}get attributeLayout(){return this._vertexPack.attributeLayout}setReferences(t){this._references=t}getBoundsInfo(){return null}getTileInfo(){return this._viewParams.tileInfo}async loadDependencies(){(function(t){if(!t)return!1;for(const e of t)switch(e.effect.type){case"CIMGeometricEffectBuffer":case"CIMGeometricEffectOffset":case"CIMGeometricEffectDonut":return!0}return!1})(this._evaluator.inputMeshParams.effects?.effectInfos)&&await(0,n.R)()}enqueueRequest(t,e,i){this._evaluator.hasDynamicProperties&&this._evaluator.enqueueRequest(t,e,i)}write(t,e,i,o,a){this.ensurePacked(e,i,o);const c=this.evaluatedMeshParams.effects;if(!c||0===c.length)return void this._write(t,i,void 0,a);const h=i.readGeometryForDisplay()?.clone();if(!h)return;const u=s.z.fromOptimizedCIM(h,i.geometryType),l=(0,n.z)();u.invertY();const p=t.id||"",d=r.V.executeEffects(c,u,p,l);let x;for(;x=d.next();)x.invertY(),this._write(t,i,x,a)}ensurePacked(t,e,i){if(!this._evaluator.hasDynamicProperties)return;const s=this._evaluator.evaluateMeshParams(t,e,i);this._vertexPack.pack(s,this._viewParams)}_writeVertex(t,e,i,s,r){const n=this.evaluatedMeshParams;this._vertexPack.writeVertex(t,e,i,s,n,r)}}},43442:(t,e,i)=>{i.d(e,{R:()=>n,z:()=>r});let s=null;function r(){return s}async function n(){s=await i.e(344).then(i.bind(i,30344))}},33121:(t,e,i)=>{i.d(e,{v:()=>c});var s=i(23572),r=i(51917),n=i(97933),o=i(68716);const a={createComputedParams:t=>t,optionalAttributes:{},attributes:{pos:{type:o.pe.SHORT,count:2,packPrecisionFactor:10,pack:"position"},id:{type:o.pe.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:o.pe.UNSIGNED_BYTE,count:1,pack:t=>0},offset:{type:o.pe.SHORT,count:2,packPrecisionFactor:16,packAlternating:{count:4,pack:({size:t})=>{const e=(0,s.Lz)(t),i=-e/2,r=-e/2;return[[i,r],[i+e,r],[i,r+e],[i+e,r+e]]}}},texCoords:{type:o.pe.SHORT,count:2,packPrecisionFactor:4,packAlternating:{count:4,pack:()=>[[0,1],[1,1],[0,0],[1,0]]}},size:{type:o.pe.UNSIGNED_BYTE,count:2,pack:({size:t})=>[t,t]},referenceSize:{type:o.pe.UNSIGNED_BYTE,count:1,pack:({size:t})=>(0,s.Lz)(t)},zoomRange:{type:o.pe.UNSIGNED_BYTE,count:2,pack:({scaleInfo:t},{tileInfo:e})=>(0,r.My)(t,e)}}};class c extends n.r{constructor(){super(...arguments),this.vertexSpec=a}_write(t,e){const i=e.getDisplayId(),r=this.evaluatedMeshParams.minPixelBuffer,n=Math.max((0,s.Lz)(this.evaluatedMeshParams.size),r);let o,a;if("esriGeometryPoint"===e.geometryType)o=e.readXForDisplay(),a=e.readYForDisplay();else{const t=e.readCentroidForDisplay();if(!t)return;o=t?.coords[0],a=t?.coords[1]}t.recordStart(this.instanceId,this.attributeLayout),t.recordBounds(o,a,n,n);const c=t.vertexCount();this._writeVertex(t,i,o,a),t.indexWrite(c+0),t.indexWrite(c+1),t.indexWrite(c+2),t.indexWrite(c+1),t.indexWrite(c+3),t.indexWrite(c+2),t.recordEnd()}}},37249:(t,e,i)=>{i.d(e,{G8:()=>L,GJ:()=>_});var s=i(4506),r=i(23572),n=i(52266),o=i(91954),a=i(99576),c=i(6538),h=i(67601),u=i(51917),l=i(43442),p=i(97933),d=i(77330),x=i(77234);class f{constructor(t){const{offsetX:e,offsetY:i,postAngle:s,fontSize:r,scaleFactor:n,transforms:o}=t;if(this.offsetX=e,this.offsetY=i,this.postAngle=s,this.fontSize=Math.min(r,96),this.transforms=o,o&&o.infos.length>1){const t=(0,x.zb)(r,s,!1,e,i,o);this.fontSize=Math.min(t.size,96),this.postAngle=t.rotation,this.offsetX=t.offsetX,this.offsetY=t.offsetY}n&&(this.fontSize*=n,this.offsetX*=n,this.offsetY*=n)}}var y=i(68716);const _=28,m=[4,4],g=[16,4],w={topLeft:g,topRight:g,bottomLeft:g,bottomRight:g},k=[4,2],v=[4,6],b={topLeft:k,topRight:k,bottomLeft:v,bottomRight:v},T={topLeft:k,topRight:v,bottomLeft:k,bottomRight:v},S={topLeft:v,topRight:v,bottomLeft:m,bottomRight:m},P={topLeft:m,topRight:m,bottomLeft:v,bottomRight:v},E={topLeft:v,topRight:m,bottomLeft:v,bottomRight:m},z={topLeft:m,topRight:v,bottomLeft:m,bottomRight:v},M={createComputedParams:t=>t,optionalAttributes:{zoomRange:{type:y.pe.UNSIGNED_SHORT,count:2,packPrecisionFactor:c.fq,packTessellation:({minZoom:t,maxZoom:e})=>[t||0,e||_]},clipAngle:{type:y.pe.UNSIGNED_BYTE,count:1,packTessellation:({clipAngle:t})=>I(t||0)},referenceSymbol:{type:y.pe.BYTE,count:4,packPrecisionFactor:1,packTessellation:(t,e)=>{if(!t.referenceBounds)return[0,0,0,0];const i=(0,a.iT)(e.horizontalAlignment),s=(0,a.Dy)(e.verticalAlignment),{offsetX:n,offsetY:o,size:c}=t.referenceBounds;return[(0,r.Lz)(n),-(0,r.Lz)(o),(0,r.Lz)(c),i+1<<2|s+1]}}},attributes:{pos:{type:y.pe.SHORT,count:2,pack:"position",packPrecisionFactor:10},id:{type:y.pe.UNSIGNED_BYTE,count:3,pack:"id"},bitset:{type:y.pe.UNSIGNED_BYTE,count:1,packTessellation:({isBackground:t,mapAligned:e})=>(0,u.xo)([[d.bg,t],[d.ti,!!e]])},offset:{type:y.pe.SHORT,count:2,packPrecisionFactor:8,packAlternating:{count:4,packTessellation:({offsets:t})=>{const{bottomLeft:e,bottomRight:i,topLeft:s,topRight:r}=t;return[s,r,e,i]}}},textureUV:{type:y.pe.SHORT,count:2,packPrecisionFactor:4,packAlternating:{count:4,packTessellation:({texcoords:t})=>{const{bottomLeft:e,bottomRight:i,topLeft:s,topRight:r}=t;return[s,r,e,i]}}},color:{type:y.pe.UNSIGNED_BYTE,count:4,normalized:!0,packTessellation:({color:t})=>t},fontSize:{type:y.pe.UNSIGNED_SHORT,count:1,packPrecisionFactor:4,packTessellation:({fontSize:t})=>(0,r.Lz)(t)},referenceSize:{type:y.pe.UNSIGNED_BYTE,count:1,packPrecisionFactor:4,packTessellation:({fontSize:t},{referenceSize:e})=>(0,r.Lz)(e??t)},haloColor:{type:y.pe.UNSIGNED_BYTE,count:4,normalized:!0,pack:({haloColor:t})=>(0,u.Jb)(t)},haloFontSize:{type:y.pe.UNSIGNED_SHORT,count:1,packPrecisionFactor:4,pack:({haloFontSize:t})=>(0,r.Lz)(t)}}};class L extends p.r{constructor(){super(...arguments),this.vertexSpec=M,this._textMeshParamsPropsInitialized=!1}ensurePacked(t,e,i){super.ensurePacked(t,e,i),this._textMeshParamsPropsInitialized&&!this._evaluator.hasDynamicProperties||(this._textMeshTransformProps=new f(this.evaluatedMeshParams),this._textMeshParamsPropsInitialized=!0)}_write(t,e,i){const s=this._getShaping();if(!s)return;const r=e.getDisplayId();if(null!=this.evaluatedMeshParams.placement)return this._writePlacedTextMarkers(t,e,s,i);if(i?.nextPath())return i.nextPoint(),this._writeGlyphs(t,r,i.x,i.y,s,0);if("esriGeometryPolygon"===e.geometryType){const i=e.readCentroidForDisplay();if(!i)return;const[n,o]=i.coords;return this._writeGlyphs(t,r,n,o,s,0)}if("esriGeometryMultipoint"===e.geometryType){const i=e.readGeometryForDisplay();return void i?.forEachVertex(((e,i)=>this._writeGlyphs(t,r,e,i,s,0)))}const n=e.readXForDisplay(),o=e.readYForDisplay();return this._writeGlyphs(t,r,n,o,s,0)}_writePlacedTextMarkers(t,e,i,s){const a=s??n.z.fromFeatureSetReaderCIM(e);if(!a)return;const c=o.l.getPlacement(a,-1,this.evaluatedMeshParams.placement,(0,r.Lz)(1),t.id,(0,l.z)());if(!c)return;const h=e.getDisplayId();let u=c.next();for(;null!=u;){const e=u.tx,s=-u.ty,r=-u.getAngle();this._writeGlyphs(t,h,e,s,i,r),u=c.next()}}_getShaping(t){const e=this._textMeshTransformProps,i=this.evaluatedMeshParams;if(!i.glyphs?.glyphs.length)return null;const n=Math.round((0,r.Lz)(e.fontSize)),o=(0,r.Lz)(e.offsetX),a=(0,r.Lz)(e.offsetY),u=(0,s.qE)((0,r.Lz)(i.lineWidth),c.GR,c.cp),l=c.DY*(0,s.qE)(i.lineHeightRatio,.25,4);return(0,h.Tl)(i.glyphs,{scale:n/c.eG,angle:e.postAngle,xOffset:o,yOffset:a,horizontalAlignment:i.horizontalAlignment,verticalAlignment:t||i.verticalAlignment,maxLineWidth:u,lineHeight:l,decoration:i.decoration,borderLineSizePx:(0,r.Lz)(i.boxBorderLineSize),hasBackground:!!i.boxBackgroundColor,useCIMAngleBehavior:i.useCIMAngleBehavior})}_writeGlyphs(t,e,i,s,n,o,a,c){const h=this.evaluatedMeshParams,l=this._textMeshTransformProps,p=l.fontSize,d=(0,r.Lz)(l.offsetX),x=(0,r.Lz)(l.offsetY),[f,y]=(0,u.My)(h.scaleInfo,this.getTileInfo());0!==o&&n.setRotation(o);const _=n.bounds,m=i+_.x+d,g=s+_.y-x,w=2*(h.minPixelBuffer?h.minPixelBuffer/p:1),k=Math.max(_.width,_.height)*w;n.textBox&&(t.recordStart(this.instanceId,this.attributeLayout,n.glyphs[0].textureBinding),t.recordBounds(m,g,k,k),this._writeTextBox(t,e,i,s,n.textBox,a,c),t.recordEnd());for(const r of n.glyphs){t.recordStart(this.instanceId,this.attributeLayout,r.textureBinding),t.recordBounds(m,g,k,k);const{texcoords:n,offsets:o}=r;this._writeQuad(t,e,i,s,{texcoords:n,offsets:o,fontSize:p,color:(0,u.Jb)(h.color),isBackground:!1,referenceBounds:a,minZoom:f,maxZoom:y,...c}),t.recordEnd()}0!==o&&n.setRotation(-o)}_writeTextBox(t,e,i,s,r,n,o){const a=this.evaluatedMeshParams,{fontSize:c}=this._textMeshTransformProps,{boxBackgroundColor:h,boxBorderLineColor:l}=a,p={isBackground:!0,fontSize:c,referenceBounds:n,...o};h&&(this._writeQuad(t,e,i,s,{texcoords:w,offsets:r.main,color:(0,u.Jb)(h),...p}),l||(this._writeQuad(t,e,i,s,{texcoords:S,offsets:r.top,color:(0,u.Jb)(h),...p}),this._writeQuad(t,e,i,s,{texcoords:P,offsets:r.bot,color:(0,u.Jb)(h),...p}),this._writeQuad(t,e,i,s,{texcoords:E,offsets:r.left,color:(0,u.Jb)(h),...p}),this._writeQuad(t,e,i,s,{texcoords:z,offsets:r.right,color:(0,u.Jb)(h),...p}))),l&&(this._writeQuad(t,e,i,s,{texcoords:b,offsets:r.top,color:(0,u.Jb)(l),...p}),this._writeQuad(t,e,i,s,{texcoords:b,offsets:r.bot,color:(0,u.Jb)(l),...p}),this._writeQuad(t,e,i,s,{texcoords:T,offsets:r.left,color:(0,u.Jb)(l),...p}),this._writeQuad(t,e,i,s,{texcoords:T,offsets:r.right,color:(0,u.Jb)(l),...p}))}_writeQuad(t,e,i,s,r){const n=t.vertexCount();this._writeVertex(t,e,i,s,r),t.indexWrite(n+0),t.indexWrite(n+1),t.indexWrite(n+2),t.indexWrite(n+1),t.indexWrite(n+3),t.indexWrite(n+2)}}const I=t=>Math.round(t*(254/360))}}]);