"use strict";(self.webpackChunkarcgis_node=self.webpackChunkarcgis_node||[]).push([[9168],{53357:(e,t,r)=>{function s(){return new Float32Array(4)}function i(e){const t=new Float32Array(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function o(e,t,r,s){const i=new Float32Array(4);return i[0]=e,i[1]=t,i[2]=r,i[3]=s,i}function n(){return s()}function a(){return o(1,1,1,1)}function l(){return o(1,0,0,0)}function h(){return o(0,1,0,0)}function c(){return o(0,0,1,0)}function d(){return o(0,0,0,1)}r.d(t,{fA:()=>o,o8:()=>i});const u=n(),_=a(),p=l(),y=h(),f=c(),m=d();Object.freeze(Object.defineProperty({__proto__:null,ONES:_,UNIT_W:m,UNIT_X:p,UNIT_Y:y,UNIT_Z:f,ZEROS:u,clone:i,create:s,createView:function(e,t){return new Float32Array(e,t,4)},fromValues:o,ones:a,unitW:d,unitX:l,unitY:h,unitZ:c,zeros:n},Symbol.toStringTag,{value:"Module"}))},68816:(e,t,r)=>{r.d(t,{w:()=>D});var s=r(82392),i=r(93814),o=r(73783),n=r(60861),a=r(81482),l=(r(6273),r(80861),r(67498),r(26325)),h=r(33330),c=r(31272),d=r(51310);const u=.3;function _(e,t){t&&Object.assign(e,t)}class p{constructor(e){this.height=90,this.coneHeight=40,this.coneWidth=23,this.width=3,this.renderOccluded=c.m$.Opaque,this.color=e.accent}}class y{constructor({colors:e,...t}){this.size=11,this.outlineSize=1,this.collisionPadding=9,this.color=e.accent,this.outlineColor=e.outline,this.renderOccluded=c.m$.Opaque,this.hoverOutlineColor=e.selectedOutline,_(this,t)}applyColor(e){this._apply(this.color,e)}applyOutline(e){this._apply(this.outlineColor,e)}applyHoverOutline(e){this._apply(this.hoverOutlineColor,e)}_apply(e,t){t.setParameters({color:(0,n.QP)(e),renderOccluded:this.renderOccluded})}}class f{constructor({colors:e,...t}){this.size=40,this.height=.2,this.offset=.25,this.collisionPadding=2,this.renderOccluded=c.m$.Transparent,this.minSquaredEdgeLength=900,this.color=(0,n._L)(e.accent,.5),this.hoverColor=e.accent,_(this,t)}applyColor(e){this._apply(this.color,e)}applyHover(e){this._apply(this.hoverColor,e)}_apply(e,t){t.setParameters({color:(0,n.QP)(e),renderOccluded:this.renderOccluded})}}class m{constructor(e){this.vertex=new y({colors:e,color:e.accent,outlineColor:e.outline}),this.edge=new y({colors:e,color:(0,n.Vl)((0,n._L)(e.accent,2/3),.5),outlineColor:(0,n._L)(e.outline,.5),size:8,collisionPadding:8}),this.selected=new y({colors:e,color:e.selected,outlineColor:e.outline}),this.edgeOffset=new f({colors:e})}}class g{constructor({colors:e,...t}){this.width=1.5,this.stipplePattern=(0,d.wk)(3.3),this.falloff=0,this.innerWidth=1.5,this.renderOccluded=c.m$.OccludeAndTransparent,this.color=e.selected,this.stippleOffColor=e.outline,this.innerColor=e.selected,_(this,t)}apply(e){e.color=(0,n.QP)(this.color),e.width=this.width,e.stipplePattern=this.stipplePattern,e.stippleOffColor=(0,n.QP)(this.stippleOffColor),e.falloff=this.falloff,e.innerWidth=this.innerWidth,e.innerColor=(0,n.QP)(this.innerColor),e.renderOccluded=this.renderOccluded}}class v{constructor({colors:e,...t}){this.size=4,this.outlineSize=1,this.shape="square",this.color=e.selected,this.outlineColor=e.outline,_(this,t)}apply(e){e.color=(0,n.QP)(this.color),e.size=this.size,e.outlineSize=this.outlineSize,e.outlineColor=(0,n.QP)(this.outlineColor),e.primitive=this.shape}}class w{constructor({colors:e,...t}){this.innerWidth=1,this.glowWidth=8,this.glowFalloff=8,this.globalAlpha=u,this.globalAlphaContrastBoost=1.5,this.radius=3,this.innerColor=e.selected,this.glowColor=e.accent,this.heightFillColor=e.accent,_(this,t)}apply(e,t=1){const r={glowColor:i.A.toUnitRGB(this.glowColor),glowFalloff:this.glowFalloff,glowWidth:this.glowWidth,innerColor:i.A.toUnitRGB(this.innerColor),innerWidth:this.innerWidth,globalAlpha:this.globalAlpha*t*this.glowColor.a,globalAlphaContrastBoost:this.globalAlphaContrastBoost,intersectsLineRadius:this.radius};"style"in e?e.style=r:e.laserlineStyle=r}}class O{constructor(e){this.outline=new g({colors:e,color:e.stippleOff,renderOccluded:c.m$.OccludeAndTransparentStencil,stippleOffColor:e.stippleOn,innerWidth:0}),this.staged=new g({colors:e,color:e.stippleOn,renderOccluded:c.m$.OccludeAndTransparentStencil,innerColor:e.stagedSolid,stippleOffColor:e.stippleOff}),this.shadowStyle=new w({colors:e,globalAlpha:u,glowColor:e.accent,glowFalloff:8,glowWidth:8,innerColor:e.selected,innerWidth:1})}}class b{constructor(e){this.outline=new v({colors:e,color:e.selected,outlineColor:e.outline,outlineSize:1,shape:"circle",size:4}),this.shadowStyle=new w({colors:e,globalAlpha:u,glowColor:e.accent,glowFalloff:1.5,glowWidth:6,innerColor:e.selected,innerWidth:1,radius:2})}}class R extends g{constructor({colors:e,...t}){super({colors:e}),this.extensionType=h.A.GROUND_RAY,_(this,t)}}class C{constructor(e){this.laserlineAlphaMultiplier=1.5,this.heightPlaneAngleCutoff=20,this.lineObjects=new O(e),this.pointObjects=new b(e),this.heightPlane=new w({colors:e,globalAlpha:u,glowColor:e.accent,glowFalloff:8,glowWidth:8,innerColor:e.selected,innerWidth:1}),this.heightBox=new w({colors:e,globalAlpha:u,glowColor:e.accent,glowFalloff:8,glowWidth:8,innerColor:e.selected,innerWidth:0,heightFillColor:e.accent}),this.zVerticalLine=new R({colors:e,color:(0,n._L)(e.accent,.5),falloff:2,innerColor:(0,n._L)(e.selected,0),renderOccluded:c.m$.OccludeAndTransparent,stipplePattern:null,width:5,extensionType:h.A.GROUND_RAY})}}let D=class extends o.A{constructor(e){super(e)}get colors(){const e=this.getTheme().accentColor,t=e.a;return{accent:e,contrast:(0,n.bJ)(e),selected:i.A.fromArray([255,255,255,t]),selectedOutline:i.A.fromArray([255,255,255,t]),staged:i.A.fromArray([12,207,255,t]),stagedSolid:i.A.fromArray([12,207,255,1]),outline:i.A.fromArray([0,0,0,.5*t]),stippleOn:i.A.fromArray([255,255,255,1]),stippleOff:i.A.fromArray([0,0,0,.5])}}get visualElements(){return new C(this.colors)}get manipulators(){return new m(this.colors)}get zManipulator(){return new p(this.colors)}};(0,s._)([(0,a.MZ)()],D.prototype,"colors",null),(0,s._)([(0,a.MZ)()],D.prototype,"visualElements",null),(0,s._)([(0,a.MZ)()],D.prototype,"manipulators",null),(0,s._)([(0,a.MZ)()],D.prototype,"zManipulator",null),(0,s._)([(0,a.MZ)()],D.prototype,"getTheme",void 0),D=(0,s._)([(0,l.$)("esri.views.3d.interactive.editingTools.settings")],D)},14788:(e,t,r)=>{r.d(t,{X:()=>v});var s=r(82392),i=r(73783),o=r(23377),n=r(81482),a=(r(6273),r(80861),r(67498),r(26325)),l=r(161),h=r(80561),c=r(34402);class d{constructor(e){this._resourceFactory=e,this._resources=null,this._visible=!0,this._attached=!1,this._renderGroup=l.O7.Outline}destroy(){this._destroyResources()}get resources(){return null!=this._resources?this._resources.external:null}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this._syncGeometriesToRenderer())}get attached(){return this._attached}set attached(e){e!==this._attached&&(this._attached=e,this._createOrDestroyResources())}get renderGroup(){return this._renderGroup}set renderGroup(e){this._renderGroup=e;const t=this._resources?.layerView;t&&(t.renderGroup=e)}recreate(){this.attached&&this._createResources()}recreateGeometry(){this._resourceFactory.recreateGeometry?null!=this._resources&&(this._ensureRenderGeometriesRemoved(),this._resourceFactory.recreateGeometry(this._resources.external),this._syncGeometriesToRenderer()):this.recreate()}_createOrDestroyResources(){this._attached?null==this._resources&&this._createResources():this._destroyResources()}_createResources(){this._destroyResources();const e=this._resourceFactory.createResources(),t=new u({view:this._resourceFactory.view,renderGroup:this._renderGroup}),r=this._resourceFactory.view.basemapTerrain?.overlayManager;this._resources={layerView:new u({view:this._resourceFactory.view,renderGroup:this._renderGroup}),external:e,geometriesAdded:!1},r&&(this._resources.drapeSourceRenderer=r.registerGeometryDrapeSource(t)),this._syncGeometriesToRenderer()}_destroyResources(){if(null==this._resources)return;this._ensureRenderGeometriesRemoved();const e=this._resourceFactory.view.basemapTerrain?.overlayManager;e&&e.unregisterDrapeSource(this._resources.layerView),this._resourceFactory.destroyResources(this._resources.external),this._resources=null}_syncGeometriesToRenderer(){this._visible?this._ensureRenderGeometriesAdded():this._ensureRenderGeometriesRemoved()}_ensureRenderGeometriesRemoved(){null!=this._resources?.drapeSourceRenderer&&this._resources.geometriesAdded&&(this._resources.drapeSourceRenderer.removeGeometries(this._resources.external.geometries,h.q.UPDATE),this._resources.geometriesAdded=!1)}_ensureRenderGeometriesAdded(){null!=this._resources?.drapeSourceRenderer&&(this._resources.geometriesAdded||(this._resources.drapeSourceRenderer.addGeometries(this._resources.external.geometries,h.q.UPDATE),this._resources.geometriesAdded=!0))}}let u=class extends((0,o.sA)(i.A)){constructor(e){super(e),this.drapeSourceType=l.Om.Features,this.updatePolicy=c.q.SYNC,this.renderGroup=l.O7.Outline}};(0,s._)([(0,n.MZ)({constructOnly:!0})],u.prototype,"view",void 0),(0,s._)([(0,n.MZ)({readOnly:!0})],u.prototype,"drapeSourceType",void 0),(0,s._)([(0,n.MZ)()],u.prototype,"renderGroup",void 0),u=(0,s._)([(0,a.$)("esri.views.3d.interactive.visualElements.DrapedVisualElementResources")],u);var _=r(51467),p=r(61985),y=r(61723),f=r(54909),m=r(5415);class g{constructor(e){this._resourceFactory=e,this._resources=null,this._visible=!0,this._attached=!1}destroy(){this._destroyResources()}get object(){return null!=this._resources?this._resources.object:null}get resources(){return null!=this._resources?this._resources.external:null}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this._syncVisible())}get attached(){return this._attached}set attached(e){e!==this._attached&&(this._attached=e,this._createOrDestroyResources())}recreate(){this.attached&&this._createResources()}recreateGeometry(){if(!this._resourceFactory.recreateGeometry)return void this.recreate();const e=this._resourceFactory.view._stage;if(null==this._resources||!e)return;const t=this._resources.object;this._resources.external.forEach((t=>{t.type!==y.X.Mesh&&t.type!==y.X.Line&&t.type!==y.X.Point||e.remove(t)})),t.removeAllGeometries(),this._resourceFactory.recreateGeometry(this._resources.external,t,this._resources.layer),this._resources.external.forEach((t=>{t.type!==y.X.Mesh&&t.type!==y.X.Line&&t.type!==y.X.Point||e.add(t)}))}_createOrDestroyResources(){this._attached?this._resources||this._createResources():this._destroyResources()}_createResources(){this._destroyResources();const e=this._resourceFactory,t=e.view,r=t._stage;if(!r)return;const s=new m.x(r,{pickable:!1,updatePolicy:c.q.SYNC}),i=new f.B({castShadow:!1}),o=e.createResources(i,s);o.forEach((e=>{r.add(e),e.type===y.X.Texture&&e.load(r.renderView.renderingContext)})),r.add(i),s.add(i);const n=e.cameraChanged,a=n?(0,p.wB)((()=>t.state.camera),(e=>n(e)),p.Vh):null;this._resources={layer:s,object:i,external:o,cameraHandle:a},this._syncVisible()}_destroyResources(){if(null==this._resources)return;const e=this._resourceFactory.view._stage;e&&(e.remove(this._resources.object),this._resources.layer.destroy(),this._resources.external.forEach((t=>{e.remove(t),t.type===y.X.Texture&&t.unload()}))),this._resources.object.dispose(),this._resources.cameraHandle?.remove(),this._resourceFactory.destroyResources(this._resources.external),this._resources=null}_syncVisible(){null!=this._resources&&(this._resources.object.visible=this._visible)}}class v extends _.B{constructor(e){super(e),this._isDraped=!1,this.object3dResources=new g(this.createObject3DResourceFactory(e.view)),this.drapedResources=new d(this.createDrapedResourceFactory(e.view)),this.isDraped=e.isDraped??!1}get isDraped(){return this._isDraped}set isDraped(e){e!==this._isDraped&&(this._isDraped=e,this.object3dResources.attached=this.attached&&!e,this.drapedResources.attached=this.attached&&e)}get renderGroup(){return this.drapedResources.renderGroup}set renderGroup(e){this.drapedResources.renderGroup=e}createResources(){this.object3dResources.attached=!this._isDraped,this.drapedResources.attached=this._isDraped}destroyResources(){this.object3dResources.attached=!1,this.drapedResources.attached=!1}recreate(){this.object3dResources.recreate(),this.drapedResources.recreate()}recreateGeometry(){this.object3dResources.recreateGeometry(),this.drapedResources.recreateGeometry()}destroy(){this.object3dResources.destroy(),this.drapedResources.destroy(),super.destroy()}updateVisibility(e){this.object3dResources.visible=e,this.drapedResources.visible=e}}},33330:(e,t,r)=>{r.d(t,{A:()=>D,U:()=>v});r(6273);var s=r(80347),i=r(19913),o=r(74772),n=r(53357),a=r(45876),l=r(74224),h=r(94669),c=r(63918),d=r(14788),u=r(95351),_=r(14583),p=r(74316),y=r(31272),f=r(35537),m=r(33763),g=r(16596);class v extends d.X{constructor(e){super(e),this._ray=(0,c.vt)(),this._isWorldDown=!1,this._start=(0,i.vt)(),this._end=(0,i.fA)(1,0,0),this._width=1,this._color=(0,n.fA)(1,0,1,1),this._polygonOffset=!1,this._writeDepthEnabled=!0,this._innerWidth=0,this._innerColor=(0,n.fA)(1,1,1,1),this._stipplePattern=null,this._stippleOffColor=null,this._stipplePreferContinuous=!0,this._falloff=0,this._extensionType=D.LINE,this._laserlineStyle=null,this._laserlineEnabled=!1,this._renderOccluded=y.m$.OccludeAndTransparent,this._fadedExtensions=G,this._laserline=new u.o({view:this.view,isDecoration:e.isDecoration}),this.applyProperties(e)}destroy(){this._laserline.destroy(),super.destroy()}createObject3DResourceFactory(e){return{view:e,createResources:e=>this._createObject3DResources(e),destroyResources:w,recreateGeometry:(e,t)=>this._recreateObject3DGeometry(e,t),cameraChanged:()=>this._updateGeometry()}}createDrapedResourceFactory(e){return{view:e,createResources:()=>this._createDrapedResources(),destroyResources:w,recreateGeometry:e=>this._recreateDrapedGeometry(e)}}updateVisibility(e){super.updateVisibility(e),this._laserline.visible=e}onAttachedChange(){this._laserline.attached=this._laserlineAttached}setStartEndFromWorldDownAtLocation(e){this._isWorldDown=!0,(0,s.c)(this._start,e),this.view.renderCoordsHelper.worldUpAtPosition(e,this._end),(0,s.f)(this._end,e,this._end),(0,c.Cr)(this._start,this._end,this._ray),this._updateGeometry()}get start(){return this._start}set start(e){this._isWorldDown=!1,(0,s.e)(this._start,e)||((0,s.c)(this._start,e),(0,c.Cr)(this._start,this._end,this._ray),this._updateGeometry())}get end(){return this._end}set end(e){this._isWorldDown=!1,(0,s.e)(this._end,e)||((0,s.c)(this._end,e),(0,c.Cr)(this._start,this._end,this._ray),this._updateGeometry())}get width(){return this._width}set width(e){e!==this._width&&(this._width=e,this._updateMaterial())}get color(){return this._color}set color(e){(0,o.a)(e,this._color)||((0,o.c)(this._color,e),this._updateMaterial())}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){e!==this._polygonOffset&&(this._polygonOffset=e,this._updateMaterial())}get writeDepthEnabled(){return this._writeDepthEnabled}set writeDepthEnabled(e){this._writeDepthEnabled!==e&&(this._writeDepthEnabled=e,this._updateMaterial())}get innerWidth(){return this._innerWidth}set innerWidth(e){e!==this._innerWidth&&(this._innerWidth=e,this._updateMaterial())}get innerColor(){return this._innerColor}set innerColor(e){(0,o.a)(e,this._innerColor)||((0,o.c)(this._innerColor,e),this._updateMaterial())}get stipplePattern(){return this._stipplePattern}set stipplePattern(e){const t=null!=e!=(null!=this._stipplePattern);this._stipplePattern=e,t?this.recreate():this._updateMaterial()}get stippleOffColor(){return this._stippleOffColor}set stippleOffColor(e){null!=e&&null!=this._stippleOffColor&&(0,o.a)(e,this._stippleOffColor)||(this._stippleOffColor=null!=e?(0,n.o8)(e):null,this._updateMaterial())}get stipplePreferContinuous(){return this._stipplePreferContinuous}set stipplePreferContinuous(e){e!==this._stipplePreferContinuous&&(this._stipplePreferContinuous=e,this._updateMaterial())}get falloff(){return this._falloff}set falloff(e){e!==this._falloff&&(this._falloff=e,this._updateMaterial())}get extensionType(){return this._extensionType}set extensionType(e){e!==this._extensionType&&(this._extensionType=e,this.recreateGeometry())}get _laserlineAttached(){return this._laserlineEnabled&&null!=this._laserlineStyle&&this.attached&&!this.isDraped}get laserlineStyle(){return this._laserlineStyle}set laserlineStyle(e){this._laserlineStyle=e,this._laserline.attached=this._laserlineAttached,null!=e&&(this._laserline.style=e)}get laserlineEnabled(){return this._laserlineEnabled}set laserlineEnabled(e){this._laserlineEnabled!==e&&(this._laserlineEnabled=e,this._laserline.attached=this._laserlineAttached)}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial())}get _normalizedRenderOccluded(){return this.isDraped&&this._renderOccluded===y.m$.OccludeAndTransparentStencil?y.m$.OccludeAndTransparent:this._renderOccluded}get fadedExtensions(){return this._fadedExtensions}set fadedExtensions(e){this._fadedExtensions=e??G,this.recreateGeometry()}_updateMaterial(){const{materialParameters:e}=this;this.object3dResources.resources?.material.setParameters(e),this.drapedResources.resources?.material.setParameters(e)}get materialParameters(){return{width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,stipplePreferContinuous:this._stipplePreferContinuous,innerWidth:this._innerWidth,innerColor:this._innerColor,falloff:this._falloff,hasPolygonOffset:this._polygonOffset,renderOccluded:this._normalizedRenderOccluded,isDecoration:this.isDecoration,writeDepth:this._writeDepthEnabled}}_createObject3DResources(e){const t=new g.W(this.materialParameters),r=new Array;return this._createObject3DGeometry(t,e,r),{material:t,geometries:r,forEach:e=>{e(t),r.forEach(e)}}}_recreateObject3DGeometry(e,t){e.geometries.length=0,this._createObject3DGeometry(e.material,t,e.geometries)}_createObject3DGeometry(e,t,r){const s=this._createGeometry(e);r.push(s),t.addGeometry(s),this._updateVerticesObject3D(t)}_createDrapedResources(){const e=new g.W(this.materialParameters);return{material:e,geometries:[this._createDrapedGeometry(e)]}}_recreateDrapedGeometry(e){e.geometries=[this._createDrapedGeometry(e.material)]}_createDrapedGeometry(e){const t=this._createGeometry(e);return this._updateVerticesDraped(t),new f.$(t)}_createGeometry(e){const t=this.extensionType===D.FADED,r=t?[(0,i.vt)(),(0,i.vt)(),(0,i.vt)(),(0,i.vt)()]:[(0,i.vt)(),(0,i.vt)()];return(0,p.Z8)(e,r,null,t?[1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,0]:null)}_updateGeometry(){if(this.isDraped)this.drapedResources.recreateGeometry();else{const e=this.object3dResources.object;e&&this._updateVerticesObject3D(e)}}_updateVerticesObject3D(e){const t=this._lineSegment;this._updateVertexAttributesObject3D(e,t),this._laserline.intersectsLine=t}_updateVerticesDraped(e){this._updateVertexAttributesDraped(e,this._lineSegment)}get _lineSegment(){return this._extensionType===D.FADED?this._updateLineSegmentFinite(C):this._updateLineSegmentInfinite(this._extensionType,C)}_updateLineSegmentFinite(e){return(0,h.Cr)(this._start,this._end,e)}_updateLineSegmentInfinite(e,t){const r=this.view.state.camera;switch((0,a.$e)(this._ray,O),e){case D.LINE:O.c0=-Number.MAX_VALUE;break;case D.RAY:case D.GROUND_RAY:{const e=this._ray.origin,t=this.view.elevationProvider.getElevation(e[0],e[1],e[2],this.view.renderCoordsHelper.spatialReference,"ground")??0,r=this.view.renderCoordsHelper.getAltitude(e);this._isWorldDown&&r<t&&(0,s.k)(O.ray.direction,O.ray.direction),this._extensionType===D.GROUND_RAY&&null!=t&&(O.c1=Math.abs(r-t));break}}if(!(0,l.ig)(r.frustum,O))return this._updateLineSegmentFinite(t);const i=(0,a.j1)(O,b),o=(0,a.mO)(O,R);return(0,h.Cr)(i,o,t)}_updateVertexAttributesObject3D(e,t){const r=e.geometries[0].getMutableAttribute(m.r.POSITION)?.data;if(!r)return;let s=0;for(const e of this._lineVertices(t))r[s++]=e[0],r[s++]=e[1],r[s++]=e[2];e.geometryVertexAttributeUpdated(e.geometries[0],m.r.POSITION)}_updateVertexAttributesDraped(e,t){const r=e.getMutableAttribute(m.r.POSITION)?.data;if(!r)return;let s=0;for(const e of this._lineVertices(t))r[s++]=e[0],r[s++]=e[1],r[s++]=_.bi;e.invalidateBoundingInfo()}*_lineVertices(e){this.extensionType===D.FADED?(yield(0,h.sd)(e,-this.fadedExtensions.start,b),yield(0,h.sd)(e,0,b),yield(0,h.sd)(e,1,b),yield(0,h.sd)(e,1+this.fadedExtensions.end,b)):(yield(0,h.sd)(e,0,b),yield(0,h.sd)(e,1,b))}}function w(e){e.geometries=[]}const O=(0,a.vt)(),b=(0,i.vt)(),R=(0,i.vt)(),C=(0,h.vt)();var D,A;(A=D||(D={}))[A.LINE=0]="LINE",A[A.RAY=1]="RAY",A[A.GROUND_RAY=2]="GROUND_RAY",A[A.FADED=3]="FADED";const P=1/3,G={start:P,end:P}},87373:(e,t,r)=>{r.d(t,{P:()=>R});var s=r(57888),i=r(80347),o=r(19913),n=r(74772),a=r(53357),l=r(88133),h=r(46373),c=r(75644),d=r(82320),u=r(19541),_=r(44223),p=r(14788),y=r(95351),f=r(93129),m=r(41410),g=r(86652),v=r(31272),w=r(35537),O=r(33763),b=r(16596);class R extends p.X{constructor(e){super(e),this._attachmentOrigin=(0,d.T)(0,0,0,null),this._attachmentOriginDirty=!0,this.events=new s.A,this._geometry=null,this._width=1,this._color=(0,a.fA)(1,0,1,1),this._innerWidth=0,this._innerColor=(0,a.fA)(1,1,1,1),this._stipplePattern=null,this._stippleOffColor=null,this._falloff=0,this._elevationInfo=null,this._laserlineStyle=null,this._laserlineEnabled=!1,this._renderOccluded=v.m$.OccludeAndTransparentStencil,this._attachmentOrigin.spatialReference=e.view.spatialReference,this._laserline=new y.o({view:e.view,isDecoration:e.isDecoration}),this.applyProperties(e),this.attached=e.attached??!0}destroy(){this._laserline.destroy(),super.destroy()}createObject3DResourceFactory(e){return{view:e,createResources:e=>this._createObject3DResources(e),destroyResources:C,recreateGeometry:(e,t)=>{e.geometries.length=0,this._recreateGeometry(t,e.material,e.geometries)}}}createDrapedResourceFactory(e){return{view:e,createResources:()=>this._createDrapedResources(),destroyResources:C,recreateGeometry:e=>{e.geometries=this._createRenderGeometriesDraped(e.material),this._attachmentOriginChanged()}}}get _laserlineAttached(){return this.attached&&this.visible&&null!=this._laserlineStyle&&!this.isDraped&&this.laserlineEnabled}onAttachedChange(e){this._laserline.attached=this._laserlineAttached,e&&this._attachmentOriginChanged()}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this.recreateGeometry()}get width(){return this._width}set width(e){e!==this._width&&(this._width=e,this._updateMaterial())}get color(){return this._color}set color(e){(0,n.a)(e,this._color)||((0,n.c)(this._color,e),this._updateMaterial())}get innerWidth(){return this._innerWidth}set innerWidth(e){e!==this._innerWidth&&(this._innerWidth=e,this._updateMaterial())}get innerColor(){return this._innerColor}set innerColor(e){(0,n.a)(e,this._innerColor)||((0,n.c)(this._innerColor,e),this._updateMaterial())}get stipplePattern(){return this._stipplePattern}set stipplePattern(e){const t=null!=e!=(null!=this._stipplePattern);this._stipplePattern=e,t?this.recreate():this._updateMaterial()}get stippleOffColor(){return this._stippleOffColor}set stippleOffColor(e){e&&this._stippleOffColor&&(0,n.a)(e,this._stippleOffColor)||(this._stippleOffColor=e?(0,a.o8)(e):null,this._updateMaterial())}get falloff(){return this._falloff}set falloff(e){e!==this._falloff&&(this._falloff=e,this._updateMaterial())}get elevationInfo(){return this._elevationInfo}set elevationInfo(e){this._elevationInfo=e,this.recreateGeometry()}get laserlineStyle(){return this._laserlineStyle}set laserlineStyle(e){this._laserlineStyle=e,this._laserline.attached=this._laserlineAttached,null!=e&&(this._laserline.style=e)}get laserlineEnabled(){return this._laserlineEnabled}set laserlineEnabled(e){this._laserlineEnabled!==e&&(this._laserlineEnabled=e,this._laserline.attached=this._laserlineAttached)}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial())}get attachmentOrigin(){if(!this._attachmentOriginDirty)return this._attachmentOrigin;const e=this.object3dResources.resources?.geometries;if(!e||0===e.length)return null;(0,i.s)(A,0,0,0);let t=0;for(const r of e)r.computeAttachmentOrigin(D)&&((0,i.g)(A,A,D),t++);return 0===t?null:((0,i.j)(A,A,1/t),this.view.renderCoordsHelper.fromRenderCoords(A,this._attachmentOrigin),this._attachmentOriginDirty=!1,this._attachmentOrigin)}_updateMaterial(){null!=this.object3dResources.resources&&this.object3dResources.resources.material.setParameters(this._materialParameters),null!=this.drapedResources.resources&&this.drapedResources.resources.material.setParameters(this._materialParameters)}get _isClosed(){return null!=this.geometry&&"polygon"===this.geometry.type}get _materialParameters(){return{width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,stipplePreferContinuous:!1,isClosed:this._isClosed,falloff:this._falloff,innerColor:this._innerColor,innerWidth:this._innerWidth,join:"round",hasPolygonOffset:!0,renderOccluded:this._normalizedRenderOccluded,isDecoration:this.isDecoration}}get _normalizedRenderOccluded(){return this.isDraped&&this._renderOccluded===v.m$.OccludeAndTransparentStencil?v.m$.OccludeAndTransparent:this._renderOccluded}_recreateGeometry(e,t,r){this._createRenderGeometries(t,r);for(const t of r)e.addGeometry(t);this._attachmentOriginChanged()}_attachmentOriginChanged(){this._attachmentOriginDirty=!0,this.events.emit("attachment-origin-changed")}_createObject3DResources(e){const t=new b.W(this._materialParameters),r=new Array;return this._recreateGeometry(e,t,r),{material:t,geometries:r,forEach:e=>{e(t),r.forEach(e)}}}_createDrapedResources(){const e=new b.W(this._materialParameters);return{material:e,geometries:this._createRenderGeometriesDraped(e)}}_createRenderGeometriesDraped(e){const{geometry:t,view:r}=this,s=r.basemapTerrain.spatialReference;return null==t||null==s?[]:(0,g.A)(t,s).lines.map((({position:t})=>{const i={overlayInfo:{spatialReference:s,renderCoordsHelper:r.renderCoordsHelper},attributeData:{position:t},removeDuplicateStartEnd:this._isClosed};return new w.$((0,m.t)(e,i))}))}calculateMapBounds(e){if(null==this.object3dResources.resources)return!1;const t=this.view.renderCoordsHelper;for(const r of this.object3dResources.resources.geometries){const s=r.attributes.get(O.r.POSITION),i=(0,c.jh)(s.data.length);(0,l.projectBuffer)(s.data,t.spatialReference,0,i,this.view.spatialReference,0,s.data.length/3),(0,h.Hq)(e,i)}return!0}_createRenderGeometries(e,t){const r=this.geometry;if(null==r)return;const s=(0,g.C)(r,this.view.elevationProvider,this.view.renderCoordsHelper,f.F.fromElevationInfo(this.elevationInfo??new _.A({mode:(0,u.w7)(r,null)}))),i=new Array;for(const{position:r,mapPositions:o}of s.lines){const s={mapPositions:o,attributeData:{position:r},removeDuplicateStartEnd:this._isClosed};t.push((0,m.t)(e,s)),i.push(r)}this._laserline.pathVerticalPlane=i}}function C(e){e.geometries=[]}const D=(0,o.vt)(),A=(0,o.vt)()},51467:(e,t,r)=>{r.d(t,{B:()=>i});r(6273);var s=r(61985);class i{get isDecoration(){return this._isDecoration}set isDecoration(e){this._isDecoration=e}constructor(e){this._isDecoration=!1,this._attached=!1,this._resourcesCreated=!1,this._visible=!0,this.view=e.view,this._handle=(0,s.wB)((()=>e.view.ready),(e=>{this._resourcesCreated&&(e?this._createResources():this._destroyResources())}))}applyProperties(e){let t=!1;for(const r in e)r in this&&("attached"===r?t=e[r]:this[r]=e[r]);this.attached=t}destroy(){this.attached=!1,this._handle.remove()}get attached(){return this._attached}set attached(e){e!==this._attached&&this.view._stage&&(this._attached=e,this._attached&&!this._resourcesCreated?this._createResources():!this._attached&&this._resourcesCreated&&this._destroyResources(),this.onAttachedChange(e))}onAttachedChange(e){}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this.attached&&this.updateVisibility(e))}_createResources(){this.createResources(),this._resourcesCreated=!0,this.updateVisibility(this.visible)}_destroyResources(){this.destroyResources(),this._resourcesCreated=!1}}},65194:(e,t,r)=>{r.d(t,{y:()=>a});var s=r(82392),i=r(57888),o=r(81482),n=(r(6273),r(80861),r(67498),r(26325));let a=class extends i.A.EventedAccessor{constructor(e){super(e),this.tracking=!1,this.displaying=!1,this.isDraped=!1}};(0,s._)([(0,o.MZ)({constructOnly:!0})],a.prototype,"graphic",void 0),(0,s._)([(0,o.MZ)()],a.prototype,"tracking",void 0),(0,s._)([(0,o.MZ)()],a.prototype,"displaying",void 0),(0,s._)([(0,o.MZ)()],a.prototype,"isDraped",void 0),a=(0,s._)([(0,n.$)("esri.views.3d.layers.graphics.GraphicState")],a)},69168:(e,t,r)=>{r.r(t),r.d(t,{ElevationProfileView3D:()=>G});var s=r(56802),i=r(57725),o=r(61985),n=r(34677),a=r(22136),l=r(3132),h=r(70214),c=r(37623),d=r(19541),u=r(68816),_=r(87373),p=r(65194),y=r(31272),f=r(96383);class m{constructor(e){this._params=e,this._highlightTask=null,this._highlightHandle=null,this._visualElementHandle=null,this._settings=new u.w({getTheme:()=>this._params.view.effectiveTheme})}destroy(){this.remove()}remove(){this._highlightTask=(0,i.DC)(this._highlightTask),this._highlightHandle=(0,i.xt)(this._highlightHandle),this._visualElementHandle=(0,i.xt)(this._visualElementHandle)}showHighlight(e){if(this.remove(),null==e||!g(e))return;const t=e.layer;this._highlightTask=(0,l.UT)((async r=>{const s=await this._params.view.whenLayerView(t);(0,c.Te)(r),(0,f.Of)(s)&&(this._highlightHandle=s.highlight(e))}))}showReshaping(e){if(this.remove(),null==e)return;const t=this._params.view,r=new _.P({view:t,geometry:g(e)?e.geometry:null,attached:!1,elevationInfo:(0,d.bh)(e),renderOccluded:y.m$.OccludeAndTransparentStencil,isDecoration:!0}),s=new p.y({graphic:e}),i=[(0,o.wB)((()=>s.isDraped),(e=>{r.isDraped=e})),s.on("changed",(()=>{r.geometry=g(e)?e.geometry:null})),t.trackGraphicState(s),t.maskOccludee(e),(0,h.DQ)(r)];this._settings.visualElements.lineObjects.outline.apply(r),r.attached=!0,this._visualElementHandle=(0,h.vE)(i)}}function g(e){return null!=e.geometry&&"polyline"===e.geometry.type}var v=r(82392),w=r(93814),O=r(73783),b=r(10565),R=r(81482),C=(r(6273),r(80861),r(67498),r(26325)),D=r(76982),A=r(38648);let P=class extends O.A{constructor(e){super(e),this._chartData=null,this._visualElements=[]}initialize(){const e=(0,b.n)((e=>{this._update(e)}),100);this.addHandles([(0,o.wB)((()=>({spatialReference:this.view.spatialReference,chartData:this._chartData})),e,o.pc),e])}destroy(){this._destroyVisualElements()}remove(){this._destroyVisualElements()}update(e){this._chartData=e}_update(e){const{chartData:t}=e;if(null==t)return this.remove();if(!t.refined)return;const r=this._visualElements,s=t.lines.filter((e=>e.viewVisualizationEnabled)),i=s.length;for(;r.length>i;)r.pop().destroy();const o=(0,n.zj)().profileLinesStyle3D;for(;r.length<i;){const e=new _.P({view:this.view,elevationInfo:{mode:"absolute-height",offset:0},innerWidth:o.width-o.outlineSize,width:o.width,falloff:o.falloff,color:o.outlineColor,renderOccluded:o.renderOccluded,isDecoration:!0});r.push(e)}const a=e.spatialReference;for(let e=0;e<i;++e){const t=r[e],o=s[i-1-e];t.geometry=this._createLineGeometry(o,a),t.innerColor=(0,D.ci)(w.A.toUnitRGBA(o.color))}}_createLineGeometry(e,t){const r=e.samples??[],s=r.length-1,i=[];let o=[];for(let e=0;e<=s;e++){const{x:t,y:n,z:a}=r[e];null!=a&&o.push([t,n,a]),e!==s&&null!=a||!o.length||(i.push(o),o=[])}return new A.A({paths:i,hasZ:!0,spatialReference:t})}_destroyVisualElements(){this._visualElements.forEach((e=>e.destroy())),this._visualElements.length=0}};(0,v._)([(0,R.MZ)()],P.prototype,"view",void 0),(0,v._)([(0,R.MZ)()],P.prototype,"_chartData",void 0),P=(0,v._)([(0,C.$)("esri.widgets.ElevationProfile.support.ProfileLines3D")],P);class G{constructor(e,t){this._handles=new s.A,this._inputRepresentation=new m({view:e}),this._hoveredPoints=new a.t({view:e}),this._profileLines=new P({view:e}),this._handles.add([(0,o.wB)((()=>t.viewModel.hoveredPoints),(e=>this._hoveredPoints.update(e)),o.pc),(0,o.wB)((()=>{const{state:e,editable:r,highlightEnabled:s,viewModel:i}=t,o=i.input;return o&&(o.commitProperty("geometry"),o.commitProperty("layer")),{input:o,state:e,editable:r,highlightEnabled:s}}),(e=>this._updateInputRepresentation(e)),o.pc),(0,o.wB)((()=>t.viewModel.chartData),(e=>this._profileLines.update(e)),o.pc),(0,o.wB)((()=>t.viewModel.input?.geometry),(()=>{this._profileLines.remove()}),o.pc)])}destroy(){this._handles=(0,i.pR)(this._handles),this._inputRepresentation=(0,i.pR)(this._inputRepresentation),this._hoveredPoints=(0,i.pR)(this._hoveredPoints),this._profileLines=(0,i.pR)(this._profileLines)}_updateInputRepresentation({input:e,state:t,editable:r,highlightEnabled:s}){const i=this._inputRepresentation;if(!s)return i.remove();t===n.o8.Selected?i.showHighlight(e):t!==n.o8.Created||r?i.remove():i.showReshaping(e)}}},22136:(e,t,r)=>{r.d(t,{t:()=>d});var s=r(82392),i=r(73783),o=r(40377),n=r(61985),a=r(81482),l=(r(6273),r(80861),r(67498),r(26325)),h=r(34677),c=r(74512);let d=class extends i.A{constructor(e){super(e),this._hoveredPoints=new o.A}initialize(){this.addHandles((0,n.wB)((()=>this._hoveredPoints.toArray().map((({anchor:e,element:t})=>({screenLocation:e.screenLocation,element:t})))),(e=>{for(const{screenLocation:t,element:r}of e)t&&(r.style.transform=`translate(${t.x}px, ${t.y}px)`)}),n.pc))}destroy(){this._hoveredPoints.drain((e=>this._destroyHoveredPoint(e)))}update(e){const t=this.view,r=this._hoveredPoints,s=e.length;for(;this._hoveredPoints.length>s;)this._destroyHoveredPoint(this._hoveredPoints.pop());for(;this._hoveredPoints.length<s;){const e=this._makeHoveredPoint();r.push(e),t.surface?.appendChild(e.element)}for(let t=0;t<s;++t){const i=r.at(s-1-t),o=e[t];this._updateHoveredPoint(i,o)}}_makeHoveredPoint(){const{size:e,borderStyle:t,borderColor:r,borderWidth:s,boxShadow:i}=(0,h.zj)().hoveredPointsStyle,o=this.view,n=new c.A({view:o,screenLocationEnabled:!0}),a=document.createElement("div"),l=a.style;return l.position="absolute",l.top="0",l.left="0",l.contain="strict",l.boxSizing="border-box",l.width=`${e}px`,l.height=`${e}px`,l.marginTop=`-${e/2}px`,l.marginLeft=`-${e/2}px`,l.border=`${t} ${s}px ${r}`,l.borderRadius=`${e}px`,l.boxShadow=i,{anchor:n,element:a}}_updateHoveredPoint({anchor:e,element:t},r){e.screenLocationEnabled=!0,e.location=r.hoveredPoint;const s=t.style;s.display="block",s.background=r.color.toCss()}_destroyHoveredPoint({anchor:e,element:t}){e.destroy(),this.view.surface?.removeChild(t)}};(0,s._)([(0,a.MZ)()],d.prototype,"view",void 0),(0,s._)([(0,a.MZ)()],d.prototype,"_hoveredPoints",void 0),d=(0,s._)([(0,l.$)("esri.widgets.ElevationProfile.support.HoveredPoints")],d)}}]);