"use strict";(self.webpackChunkarcgis_node=self.webpackChunkarcgis_node||[]).push([[4973],{53357:(e,t,r)=>{function s(){return new Float32Array(4)}function i(e){const t=new Float32Array(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function n(e,t,r,s){const i=new Float32Array(4);return i[0]=e,i[1]=t,i[2]=r,i[3]=s,i}function o(){return s()}function a(){return n(1,1,1,1)}function l(){return n(1,0,0,0)}function c(){return n(0,1,0,0)}function u(){return n(0,0,1,0)}function d(){return n(0,0,0,1)}r.d(t,{fA:()=>n,o8:()=>i});const h=o(),p=a(),_=l(),m=c(),f=u(),g=d();Object.freeze(Object.defineProperty({__proto__:null,ONES:p,UNIT_W:g,UNIT_X:_,UNIT_Y:m,UNIT_Z:f,ZEROS:h,clone:i,create:s,createView:function(e,t){return new Float32Array(e,t,4)},fromValues:n,ones:a,unitW:d,unitX:l,unitY:c,unitZ:u,zeros:o},Symbol.toStringTag,{value:"Module"}))},8035:(e,t,r)=>{r.d(t,{s:()=>$});var s=r(93814),i=r(60861),n=(r(6273),r(70214)),o=r(80347),a=r(19913),l=r(42722),c=r(19541),u=r(33330),d=r(61985),h=r(23572),p=r(53334),_=r(56560),m=r(74772),f=r(53357),g=r(82320),y=r(14788),v=r(14583),R=r(74316),O=r(31272),b=r(35537),D=r(33763),x=r(16596);class w extends y.X{constructor(e){super(e),this._location=(0,a.vt)(),this._direction=(0,a.fA)(1,0,0),this._width=1,this._offset=1,this._length=18,this._color=(0,f.fA)(1,0,1,1),this._renderOccluded=O.m$.OccludeAndTransparent,this.applyProperties(e)}createObject3DResourceFactory(e){return{view:e,createResources:e=>this._createObject3DResources(e),destroyResources:P,recreateGeometry:(e,t)=>this._recreateObject3DGeometry(e,t),cameraChanged:()=>this._updateGeometry()}}createDrapedResourceFactory(e){return{view:e,createResources:()=>this._createDrapedResources(),destroyResources:E,recreateGeometry:e=>this._recreateDrapedGeometry(e)}}get location(){return this._location}set location(e){(0,o.e)(this._location,e)||((0,o.c)(this._location,e),this._updateGeometry())}get direction(){return this._direction}set direction(e){(0,o.e)(this._direction,e)||((0,o.c)(this._direction,e),this._updateGeometry())}setDirectionFromPoints(e,t){(0,o.n)(this._direction,(0,o.f)(this._direction,t,e)),this._updateGeometry()}get width(){return this._width}set width(e){e!==this._width&&(this._width=e,this._updateMaterial())}get offset(){return this._offset}set offset(e){e!==this._offset&&(this._offset=e,this._updateGeometry())}get length(){return this._length}set length(e){e!==this._length&&(this._length=e,this._updateGeometry())}get color(){return this._color}set color(e){(0,m.a)(e,this._color)||((0,m.c)(this._color,e),this._updateMaterial())}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial())}_createObject3DResources(e){const t=new x.W(this.materialParameters),r=new Array;return this._createObject3DGeometry(t,e,r),{material:t,geometries:r,forEach:e=>{e(t),r.forEach(e)}}}_recreateObject3DGeometry(e,t){e.geometries.length=0,this._createObject3DGeometry(e.material,t,e.geometries)}_createObject3DGeometry(e,t,r){const[s,i]=S(e);t.addGeometry(s),t.addGeometry(i),r.push(s),r.push(i),this._updateVerticesObject3D(t)}_createDrapedResources(){const e=new x.W(this.materialParameters),t=(0,d.wB)((()=>this.view.state.contentPixelRatio),(()=>{this.drapedResources.recreateGeometry()}));return{material:e,geometries:this._createDrapedGeometry(e),pixelRatioHandle:t}}_recreateDrapedGeometry(e){e.geometries=this._createDrapedGeometry(e.material)}_createDrapedGeometry(e){const t=S(e);return this._updateVerticesDraped(t),t.map((e=>new b.$(e)))}_updateMaterial(){const{materialParameters:e}=this;this.object3dResources.resources?.material.setParameters(e),this.drapedResources.resources?.material.setParameters(e)}get materialParameters(){return{width:this._width,color:this._color,renderOccluded:this._renderOccluded,isDecoration:this.isDecoration}}_updateGeometry(){if(this.isDraped)this.drapedResources.recreateGeometry();else{const e=this.object3dResources.object;e&&this._updateVerticesObject3D(e)}}_updateVerticesObject3D(e){const t=this.view.state.camera;t.projectToScreen(this.location,M),(0,o.g)(A,this.location,this.direction),t.projectToScreen(A,j),(0,p.S8)(j,(0,p.Re)(j,j,M)),this._updateVertexAttributesObject3D(t,e,0,M,j,1),this._updateVertexAttributesObject3D(t,e,1,M,j,-1)}_updateVertexAttributesObject3D(e,t,r,s,i,n){const o=t.geometries[r],a=o.getMutableAttribute(D.r.POSITION)?.data;if(!a)return;const{start:l,end:c}=G(i,s,n,this.offset,this.width,this.length);e.unprojectFromScreen((0,h.PR)(l),A),a[0]=A[0],a[1]=A[1],a[2]=A[2],e.unprojectFromScreen((0,h.PR)(c),A),a[3]=A[0],a[4]=A[1],a[5]=A[2],t.geometryVertexAttributeUpdated(o,D.r.POSITION)}_updateVerticesDraped(e){const{view:{basemapTerrain:{overlayManager:t},state:{contentPixelRatio:r}}}=this,{location:s,width:i,length:n,offset:o}=this,a=F;a.spatialReference=t.renderer.spatialReference,a.x=s[0],a.y=s[1];const l=this.view.overlayPixelSizeInMapUnits(a)*r,c=i*l,u=n*l,d=o*l;this._updateVertexAttributesDraped(e[0],c,u,d,-1),this._updateVertexAttributesDraped(e[1],c,u,d,1)}_updateVertexAttributesDraped(e,t,r,s,i){const n=e.getMutableAttribute(D.r.POSITION)?.data;if(!n)return;const{location:o,direction:a}=this,{start:l,end:c}=G(a,o,i,s,t,r);n[0]=l[0],n[1]=l[1],n[2]=v.bi,n[3]=c[0],n[4]=c[1],n[5]=v.bi,e.invalidateBoundingInfo()}}function S(e){return[(0,R.Z8)(e,[(0,a.vt)(),(0,a.vt)()]),(0,R.Z8)(e,[(0,a.vt)(),(0,a.vt)()])]}function G(e,t,r,s,i,n){const o=(0,p.hs)(C,(0,p.hZ)(C,e[1]*r,e[0]*-r),s+i/2),a=(0,p.WQ)(T,(0,p.WQ)(T,(0,p.WQ)(T,t,(0,p.hs)(T,e,n/2)),o),o);return{start:a,end:(0,p.WQ)(z,a,(0,p.hs)(z,e,-n))}}function P(e){e.geometries.length=0}function E(e){e.pixelRatioHandle.remove(),e.geometries=[]}const A=(0,a.vt)(),C=(0,_.vt)(),T=(0,_.vt)(),z=(0,_.vt)(),M=(0,h.gs)(),j=(0,h.gs)(),F=(0,g.T)(0,0,void 0,null);var I=r(83157),H=r(57657),N=r(161),V=r(93617),q=r(51879),U=r(49982),W=r(53981),Z=r(36598),L=r(56142),k=r(5073);class $ extends Z.b{sortUniqueHints(e){return e.sort(((e,t)=>(t instanceof L.c?t.length:0)-(e instanceof L.c?e.length:0)))}visualizeIntersectionPoint(e,t){const{spatialReference:r,view:s}=t,i=X(t);return(0,n.DQ)(new I.l({view:s,primitive:"circle",geometry:(0,V.io)(e.intersectionPoint,r),elevationInfo:e.isDraped?c.Tq:c.qt,size:20,outlineSize:2,color:i.intersectionPointColor,outlineColor:i.intersectionPointOutlineColor,pixelSnappingEnabled:!1,isDecoration:!0,attached:!0}))}visualizePoint(e,t){const{view:r,spatialReference:s}=t,i=X(t),o=Q(e.point,e.domain,t);return(0,n.DQ)(new I.l({view:r,primitive:"circle",geometry:(0,V.io)(o,s),elevationInfo:B(e),size:20,outlineSize:2,color:i.pointColor,outlineColor:i.pointOutlineColor,pixelSnappingEnabled:!1,isDecoration:!0,attached:!0}))}visualizeLine(e,t){const{view:r,spatialReference:s}=t,i=X(t),o=Q(e.lineStart,e.domain,t),a=Q(e.lineEnd,e.domain,t);return(0,n.DQ)(function(e,t,r,s,i,n,o,a=!1,l=!0,c=!0){const d=Y(t,s,i,n,a),h=Y(r,s,i,n,a),p=new u.U({view:n,extensionType:u.A.FADED,start:d,end:h,isDraped:a,color:o.lineColor,renderOccluded:a?O.m$.OccludeAndTransparent:O.m$.Opaque,renderGroup:N.O7.SnappingHint,isDecoration:!0});switch(e){case W.H3.TARGET:p.width=q.N.lineHintWidthTarget,p.fadedExtensions={start:0,end:q.N.lineHintFadedExtensions};break;case W.H3.REFERENCE_EXTENSION:p.width=q.N.lineHintWidthReference,p.fadedExtensions={start:0,end:0};break;case W.H3.REFERENCE:p.width=q.N.lineHintWidthReference,p.fadedExtensions={start:l?q.N.lineHintFadedExtensions:0,end:c?q.N.lineHintFadedExtensions:0}}return p.attached=!0,p}(e.type,o,a,s,B(e),r,i,e.isDraped,e.fadeLeft,e.fadeRight))}visualizeParallelSign(e,t){const{view:r,spatialReference:s}=t,i=X(t),{isDraped:a}=e,l=B(e),c=Q(e.lineStart,e.domain,t),u=Q(e.lineEnd,e.domain,t),d=Y(c,s,l,r,a),h=Y(u,s,l,r,a),p=(0,o.o)(h,d,h,.5),_=new w({view:r,attached:!1,offset:q.N.parallelLineHintOffset,length:q.N.parallelLineHintLength,width:q.N.parallelLineHintWidth,color:i.parallelSignColor,location:p,renderOccluded:a?O.m$.OccludeAndTransparent:O.m$.Opaque,isDraped:a,renderGroup:N.O7.SnappingHint,isDecoration:!0});return _.setDirectionFromPoints(d,p),_.attached=!0,(0,n.DQ)(_)}visualizeRightAngleQuad(e,t){const{view:r,spatialReference:s}=t,i=X(t),o=B(e),{isDraped:a}=e,l=Q(e.previousVertex,e.domain,t),c=Q(e.centerVertex,e.domain,t),u=Q(e.nextVertex,e.domain,t),d=Y(l,s,o,r,a),h=Y(c,s,o,r,a),p=Y(u,s,o,r,a);return(0,n.DQ)(new H.n({view:r,attached:!0,color:a?i.rightAngleColorDraped:i.rightAngleColor,renderOccluded:a?O.m$.OccludeAndTransparent:O.m$.Transparent,outlineRenderOccluded:a?O.m$.OccludeAndTransparent:O.m$.Opaque,outlineColor:i.rightAngleOutlineColor,outlineSize:q.N.rightAngleHintOutlineSize,size:q.N.rightAngleHintSize,isDraped:a,geometry:{previous:d,center:h,next:p},renderGroup:N.O7.SnappingHint,isDecoration:!0}))}}function X(e){const{effectiveTheme:t}=e.view,r=s.A.toUnitRGBA(t.accentColor),n=[0,0,0,0];return{intersectionPointColor:n,intersectionPointOutlineColor:r,pointColor:n,pointOutlineColor:r,lineColor:r,lineOutlineColor:void 0,parallelSignColor:r,rightAngleColor:r,rightAngleColorDraped:s.A.toUnitRGBA((0,i._L)(t.accentColor,.5)),rightAngleOutlineColor:r}}function Q(e,t,{selfSnappingZ:r,view:s,spatialReference:i}){return t&U.n.SELF&&(0,V.Ex)(e)&&null!=r?(0,V.FH)(e,r,s,i):e}function B(e){return e.isDraped?c.Tq:c.qt}function Y(e,t,r,s,i){const n=(0,a.vt)();if(i){const r=s.basemapTerrain.overlayManager.renderer.spatialReference;(0,l.F)(e,t,n,r)}else(0,k.XG)(e,t,r,s,n);return n}},61506:(e,t,r)=>{r.d(t,{AA:()=>R,L2:()=>x,Og:()=>s,PW:()=>D,U0:()=>O,iv:()=>w,mg:()=>G,ov:()=>S,xk:()=>E,z7:()=>P});r(3313);var s,i,n=r(23572),o=r(80347),a=r(19913),l=r(34561),c=r(87368),u=r(63918),d=r(74695),h=r(11631),p=r(19541),_=r(86300),m=r(57809),f=r(30165),g=r(72559),y=r(66019),v=r(1912);function R(e,t){return b(e,(()=>t))}function O(e){return b(e,(e=>e.plane))}function b(e,t){const r=(0,a.vt)(),s=(0,a.vt)();let i=!1;return o=>{const a=t(o);if("start"===o.action){const t=(0,n.WA)(o.screenStart,(0,n.PR)(h.oG.get())),s=(0,_.Z4)(e.state.camera,t,T);null!=s&&(i=(0,c.Ui)(a,s,r))}if(!i)return null;const l=(0,n.WA)(o.screenEnd,(0,n.PR)(h.oG.get())),u=(0,_.Z4)(e.state.camera,l,T);return null==u?null:(0,c.Ui)(a,u,s)?{...o,renderStart:r,renderEnd:s,plane:a,ray:u}:null}}function D(e,t,r,s=null,i=null){return function(e,t,r=0,s=null,i=null){let o=null;return a=>{if("start"===a.action&&(o=e.sceneIntersectionHelper.intersectElevationFromScreen((0,n.gs)(a.screenStart.x,a.screenStart.y),t,r,i),null!=o&&null!=s&&!(0,l.projectPoint)(o,o,s)))return null;if(null==o)return null;const c=e.sceneIntersectionHelper.intersectElevationFromScreen((0,n.gs)(a.screenEnd.x,a.screenEnd.y),t,r,i);return null==c||null!=s&&!(0,l.projectPoint)(c,c,s)?null:{...a,mapStart:o,mapEnd:c}}}(e,r,(0,p.id)(t,e,r),s,i)}function x(e,t,r,s){const i=r.toMap(e.screenStart);return null!=i?D(t,i,r.elevationInfo,s):null}function w(e,t,r){let s=null;const i=new y.rh;return i.next(R(e,function(e,t){const r=A,s=C,i=(0,c.vt)();e.renderCoordsHelper.worldUpAtPosition(t,r);const n=(0,o.b)((0,c.Qj)(i),r,(0,o.f)(s,t,e.state.camera.eye));return(0,o.b)(n,n,r),(0,c.O_)(t,n,i)}(e,t))).next(function(e,t){const r=(0,a.vt)(),s=(0,o.l)(t);e.renderCoordsHelper.worldUpAtPosition(t,r);const i=(0,a.vt)(),n=(0,a.vt)(),l=i=>((0,o.f)(i,i,t),(0,d._I)(r,i,i),"global"===e.viewingMode&&(0,o.l)(i)*Math.sign((0,o.m)(r,i))<.001-s&&(0,o.f)(i,(0,o.j)(i,r,.001),t),(0,o.g)(i,i,t),i);return e=>(e.renderStart=l((0,o.c)(i,e.renderStart)),e.renderEnd=l((0,o.c)(n,e.renderEnd)),e)}(e,t)).next(G(e,r)).next((e=>{e.mapEnd.x=e.mapStart.x,e.mapEnd.y=e.mapStart.y,s=e})),e=>(s=null,i.execute(e),s)}function S(e,t){const r=r=>{const s=(0,n.WA)(r,(0,n.PR)(h.oG.get())),i=(0,_.Z4)(e.state.camera,s,T);return null==i?null:(0,u.Zb)(t,i,A,C)[1]};return e=>{const t=r(e.screenStart);if(null==t)return null;const s=r(e.screenEnd);return null==s?null:{...e,renderStart:t,renderEnd:s}}}function G(e,t){const r=e.renderCoordsHelper;return e=>{const s=r.fromRenderCoords(e.renderStart,new v.A({spatialReference:t})),i=r.fromRenderCoords(e.renderEnd,new v.A({spatialReference:t}));return null!=s&&null!=i?{...e,mapStart:s,mapEnd:i}:null}}function P(e){let t=null;return r=>{switch(r.action){case"start":t=e.disableDisplay();break;case"end":case"cancel":null!=t&&(t.remove(),t=null)}return r}}function E(e,t=null){const r=(0,m.hz)(e.state.viewingMode);r.options.selectionMode=!0,r.options.store=f.oH.MIN,r.options.hud=!1;const i=(0,n.gs)(),o={requiresGroundFeedback:!0,enableDraped:!0,exclude:new Set},l=(0,a.vt)(),c=t??e.spatialReference,u=t=>{e.map.ground&&e.map.ground.opacity<1?o.exclude.add(g.fo):o.exclude.delete(g.fo),e.sceneIntersectionHelper.intersectIntersectorScreen((0,n.WA)(t,i),r,o);const a=r.results.min;let u;if(a.getIntersectionPoint(l))u=a.intersector===f.dz.TERRAIN?s.GROUND:s.OTHER;else{if(!r.results.ground.getIntersectionPoint(l))return null;u=s.GROUND}return{location:e.renderCoordsHelper.fromRenderCoords(l,new v.A({spatialReference:c})),surfaceType:u}};let d;return e=>{if("start"===e.action){const t=u(e.screenStart);d=null!=t?t.location:null}if(null==d)return null;const t=u(e.screenEnd);return null!=t?.location?{...e,mapStart:d,mapEnd:t.location,surfaceType:t.surfaceType}:null}}(i=s||(s={}))[i.GROUND=0]="GROUND",i[i.OTHER=1]="OTHER";const A=(0,a.vt)(),C=(0,a.vt)(),T=(0,u.vt)()},14788:(e,t,r)=>{r.d(t,{X:()=>v});var s=r(82392),i=r(73783),n=r(23377),o=r(81482),a=(r(6273),r(80861),r(67498),r(26325)),l=r(161),c=r(80561),u=r(34402);class d{constructor(e){this._resourceFactory=e,this._resources=null,this._visible=!0,this._attached=!1,this._renderGroup=l.O7.Outline}destroy(){this._destroyResources()}get resources(){return null!=this._resources?this._resources.external:null}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this._syncGeometriesToRenderer())}get attached(){return this._attached}set attached(e){e!==this._attached&&(this._attached=e,this._createOrDestroyResources())}get renderGroup(){return this._renderGroup}set renderGroup(e){this._renderGroup=e;const t=this._resources?.layerView;t&&(t.renderGroup=e)}recreate(){this.attached&&this._createResources()}recreateGeometry(){this._resourceFactory.recreateGeometry?null!=this._resources&&(this._ensureRenderGeometriesRemoved(),this._resourceFactory.recreateGeometry(this._resources.external),this._syncGeometriesToRenderer()):this.recreate()}_createOrDestroyResources(){this._attached?null==this._resources&&this._createResources():this._destroyResources()}_createResources(){this._destroyResources();const e=this._resourceFactory.createResources(),t=new h({view:this._resourceFactory.view,renderGroup:this._renderGroup}),r=this._resourceFactory.view.basemapTerrain?.overlayManager;this._resources={layerView:new h({view:this._resourceFactory.view,renderGroup:this._renderGroup}),external:e,geometriesAdded:!1},r&&(this._resources.drapeSourceRenderer=r.registerGeometryDrapeSource(t)),this._syncGeometriesToRenderer()}_destroyResources(){if(null==this._resources)return;this._ensureRenderGeometriesRemoved();const e=this._resourceFactory.view.basemapTerrain?.overlayManager;e&&e.unregisterDrapeSource(this._resources.layerView),this._resourceFactory.destroyResources(this._resources.external),this._resources=null}_syncGeometriesToRenderer(){this._visible?this._ensureRenderGeometriesAdded():this._ensureRenderGeometriesRemoved()}_ensureRenderGeometriesRemoved(){null!=this._resources?.drapeSourceRenderer&&this._resources.geometriesAdded&&(this._resources.drapeSourceRenderer.removeGeometries(this._resources.external.geometries,c.q.UPDATE),this._resources.geometriesAdded=!1)}_ensureRenderGeometriesAdded(){null!=this._resources?.drapeSourceRenderer&&(this._resources.geometriesAdded||(this._resources.drapeSourceRenderer.addGeometries(this._resources.external.geometries,c.q.UPDATE),this._resources.geometriesAdded=!0))}}let h=class extends((0,n.sA)(i.A)){constructor(e){super(e),this.drapeSourceType=l.Om.Features,this.updatePolicy=u.q.SYNC,this.renderGroup=l.O7.Outline}};(0,s._)([(0,o.MZ)({constructOnly:!0})],h.prototype,"view",void 0),(0,s._)([(0,o.MZ)({readOnly:!0})],h.prototype,"drapeSourceType",void 0),(0,s._)([(0,o.MZ)()],h.prototype,"renderGroup",void 0),h=(0,s._)([(0,a.$)("esri.views.3d.interactive.visualElements.DrapedVisualElementResources")],h);var p=r(51467),_=r(61985),m=r(61723),f=r(54909),g=r(5415);class y{constructor(e){this._resourceFactory=e,this._resources=null,this._visible=!0,this._attached=!1}destroy(){this._destroyResources()}get object(){return null!=this._resources?this._resources.object:null}get resources(){return null!=this._resources?this._resources.external:null}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this._syncVisible())}get attached(){return this._attached}set attached(e){e!==this._attached&&(this._attached=e,this._createOrDestroyResources())}recreate(){this.attached&&this._createResources()}recreateGeometry(){if(!this._resourceFactory.recreateGeometry)return void this.recreate();const e=this._resourceFactory.view._stage;if(null==this._resources||!e)return;const t=this._resources.object;this._resources.external.forEach((t=>{t.type!==m.X.Mesh&&t.type!==m.X.Line&&t.type!==m.X.Point||e.remove(t)})),t.removeAllGeometries(),this._resourceFactory.recreateGeometry(this._resources.external,t,this._resources.layer),this._resources.external.forEach((t=>{t.type!==m.X.Mesh&&t.type!==m.X.Line&&t.type!==m.X.Point||e.add(t)}))}_createOrDestroyResources(){this._attached?this._resources||this._createResources():this._destroyResources()}_createResources(){this._destroyResources();const e=this._resourceFactory,t=e.view,r=t._stage;if(!r)return;const s=new g.x(r,{pickable:!1,updatePolicy:u.q.SYNC}),i=new f.B({castShadow:!1}),n=e.createResources(i,s);n.forEach((e=>{r.add(e),e.type===m.X.Texture&&e.load(r.renderView.renderingContext)})),r.add(i),s.add(i);const o=e.cameraChanged,a=o?(0,_.wB)((()=>t.state.camera),(e=>o(e)),_.Vh):null;this._resources={layer:s,object:i,external:n,cameraHandle:a},this._syncVisible()}_destroyResources(){if(null==this._resources)return;const e=this._resourceFactory.view._stage;e&&(e.remove(this._resources.object),this._resources.layer.destroy(),this._resources.external.forEach((t=>{e.remove(t),t.type===m.X.Texture&&t.unload()}))),this._resources.object.dispose(),this._resources.cameraHandle?.remove(),this._resourceFactory.destroyResources(this._resources.external),this._resources=null}_syncVisible(){null!=this._resources&&(this._resources.object.visible=this._visible)}}class v extends p.B{constructor(e){super(e),this._isDraped=!1,this.object3dResources=new y(this.createObject3DResourceFactory(e.view)),this.drapedResources=new d(this.createDrapedResourceFactory(e.view)),this.isDraped=e.isDraped??!1}get isDraped(){return this._isDraped}set isDraped(e){e!==this._isDraped&&(this._isDraped=e,this.object3dResources.attached=this.attached&&!e,this.drapedResources.attached=this.attached&&e)}get renderGroup(){return this.drapedResources.renderGroup}set renderGroup(e){this.drapedResources.renderGroup=e}createResources(){this.object3dResources.attached=!this._isDraped,this.drapedResources.attached=this._isDraped}destroyResources(){this.object3dResources.attached=!1,this.drapedResources.attached=!1}recreate(){this.object3dResources.recreate(),this.drapedResources.recreate()}recreateGeometry(){this.object3dResources.recreateGeometry(),this.drapedResources.recreateGeometry()}destroy(){this.object3dResources.destroy(),this.drapedResources.destroy(),super.destroy()}updateVisibility(e){this.object3dResources.visible=e,this.drapedResources.visible=e}}},33330:(e,t,r)=>{r.d(t,{A:()=>w,U:()=>v});r(6273);var s=r(80347),i=r(19913),n=r(74772),o=r(53357),a=r(45876),l=r(74224),c=r(94669),u=r(63918),d=r(14788),h=r(95351),p=r(14583),_=r(74316),m=r(31272),f=r(35537),g=r(33763),y=r(16596);class v extends d.X{constructor(e){super(e),this._ray=(0,u.vt)(),this._isWorldDown=!1,this._start=(0,i.vt)(),this._end=(0,i.fA)(1,0,0),this._width=1,this._color=(0,o.fA)(1,0,1,1),this._polygonOffset=!1,this._writeDepthEnabled=!0,this._innerWidth=0,this._innerColor=(0,o.fA)(1,1,1,1),this._stipplePattern=null,this._stippleOffColor=null,this._stipplePreferContinuous=!0,this._falloff=0,this._extensionType=w.LINE,this._laserlineStyle=null,this._laserlineEnabled=!1,this._renderOccluded=m.m$.OccludeAndTransparent,this._fadedExtensions=P,this._laserline=new h.o({view:this.view,isDecoration:e.isDecoration}),this.applyProperties(e)}destroy(){this._laserline.destroy(),super.destroy()}createObject3DResourceFactory(e){return{view:e,createResources:e=>this._createObject3DResources(e),destroyResources:R,recreateGeometry:(e,t)=>this._recreateObject3DGeometry(e,t),cameraChanged:()=>this._updateGeometry()}}createDrapedResourceFactory(e){return{view:e,createResources:()=>this._createDrapedResources(),destroyResources:R,recreateGeometry:e=>this._recreateDrapedGeometry(e)}}updateVisibility(e){super.updateVisibility(e),this._laserline.visible=e}onAttachedChange(){this._laserline.attached=this._laserlineAttached}setStartEndFromWorldDownAtLocation(e){this._isWorldDown=!0,(0,s.c)(this._start,e),this.view.renderCoordsHelper.worldUpAtPosition(e,this._end),(0,s.f)(this._end,e,this._end),(0,u.Cr)(this._start,this._end,this._ray),this._updateGeometry()}get start(){return this._start}set start(e){this._isWorldDown=!1,(0,s.e)(this._start,e)||((0,s.c)(this._start,e),(0,u.Cr)(this._start,this._end,this._ray),this._updateGeometry())}get end(){return this._end}set end(e){this._isWorldDown=!1,(0,s.e)(this._end,e)||((0,s.c)(this._end,e),(0,u.Cr)(this._start,this._end,this._ray),this._updateGeometry())}get width(){return this._width}set width(e){e!==this._width&&(this._width=e,this._updateMaterial())}get color(){return this._color}set color(e){(0,n.a)(e,this._color)||((0,n.c)(this._color,e),this._updateMaterial())}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){e!==this._polygonOffset&&(this._polygonOffset=e,this._updateMaterial())}get writeDepthEnabled(){return this._writeDepthEnabled}set writeDepthEnabled(e){this._writeDepthEnabled!==e&&(this._writeDepthEnabled=e,this._updateMaterial())}get innerWidth(){return this._innerWidth}set innerWidth(e){e!==this._innerWidth&&(this._innerWidth=e,this._updateMaterial())}get innerColor(){return this._innerColor}set innerColor(e){(0,n.a)(e,this._innerColor)||((0,n.c)(this._innerColor,e),this._updateMaterial())}get stipplePattern(){return this._stipplePattern}set stipplePattern(e){const t=null!=e!=(null!=this._stipplePattern);this._stipplePattern=e,t?this.recreate():this._updateMaterial()}get stippleOffColor(){return this._stippleOffColor}set stippleOffColor(e){null!=e&&null!=this._stippleOffColor&&(0,n.a)(e,this._stippleOffColor)||(this._stippleOffColor=null!=e?(0,o.o8)(e):null,this._updateMaterial())}get stipplePreferContinuous(){return this._stipplePreferContinuous}set stipplePreferContinuous(e){e!==this._stipplePreferContinuous&&(this._stipplePreferContinuous=e,this._updateMaterial())}get falloff(){return this._falloff}set falloff(e){e!==this._falloff&&(this._falloff=e,this._updateMaterial())}get extensionType(){return this._extensionType}set extensionType(e){e!==this._extensionType&&(this._extensionType=e,this.recreateGeometry())}get _laserlineAttached(){return this._laserlineEnabled&&null!=this._laserlineStyle&&this.attached&&!this.isDraped}get laserlineStyle(){return this._laserlineStyle}set laserlineStyle(e){this._laserlineStyle=e,this._laserline.attached=this._laserlineAttached,null!=e&&(this._laserline.style=e)}get laserlineEnabled(){return this._laserlineEnabled}set laserlineEnabled(e){this._laserlineEnabled!==e&&(this._laserlineEnabled=e,this._laserline.attached=this._laserlineAttached)}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial())}get _normalizedRenderOccluded(){return this.isDraped&&this._renderOccluded===m.m$.OccludeAndTransparentStencil?m.m$.OccludeAndTransparent:this._renderOccluded}get fadedExtensions(){return this._fadedExtensions}set fadedExtensions(e){this._fadedExtensions=e??P,this.recreateGeometry()}_updateMaterial(){const{materialParameters:e}=this;this.object3dResources.resources?.material.setParameters(e),this.drapedResources.resources?.material.setParameters(e)}get materialParameters(){return{width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,stipplePreferContinuous:this._stipplePreferContinuous,innerWidth:this._innerWidth,innerColor:this._innerColor,falloff:this._falloff,hasPolygonOffset:this._polygonOffset,renderOccluded:this._normalizedRenderOccluded,isDecoration:this.isDecoration,writeDepth:this._writeDepthEnabled}}_createObject3DResources(e){const t=new y.W(this.materialParameters),r=new Array;return this._createObject3DGeometry(t,e,r),{material:t,geometries:r,forEach:e=>{e(t),r.forEach(e)}}}_recreateObject3DGeometry(e,t){e.geometries.length=0,this._createObject3DGeometry(e.material,t,e.geometries)}_createObject3DGeometry(e,t,r){const s=this._createGeometry(e);r.push(s),t.addGeometry(s),this._updateVerticesObject3D(t)}_createDrapedResources(){const e=new y.W(this.materialParameters);return{material:e,geometries:[this._createDrapedGeometry(e)]}}_recreateDrapedGeometry(e){e.geometries=[this._createDrapedGeometry(e.material)]}_createDrapedGeometry(e){const t=this._createGeometry(e);return this._updateVerticesDraped(t),new f.$(t)}_createGeometry(e){const t=this.extensionType===w.FADED,r=t?[(0,i.vt)(),(0,i.vt)(),(0,i.vt)(),(0,i.vt)()]:[(0,i.vt)(),(0,i.vt)()];return(0,_.Z8)(e,r,null,t?[1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,0]:null)}_updateGeometry(){if(this.isDraped)this.drapedResources.recreateGeometry();else{const e=this.object3dResources.object;e&&this._updateVerticesObject3D(e)}}_updateVerticesObject3D(e){const t=this._lineSegment;this._updateVertexAttributesObject3D(e,t),this._laserline.intersectsLine=t}_updateVerticesDraped(e){this._updateVertexAttributesDraped(e,this._lineSegment)}get _lineSegment(){return this._extensionType===w.FADED?this._updateLineSegmentFinite(x):this._updateLineSegmentInfinite(this._extensionType,x)}_updateLineSegmentFinite(e){return(0,c.Cr)(this._start,this._end,e)}_updateLineSegmentInfinite(e,t){const r=this.view.state.camera;switch((0,a.$e)(this._ray,O),e){case w.LINE:O.c0=-Number.MAX_VALUE;break;case w.RAY:case w.GROUND_RAY:{const e=this._ray.origin,t=this.view.elevationProvider.getElevation(e[0],e[1],e[2],this.view.renderCoordsHelper.spatialReference,"ground")??0,r=this.view.renderCoordsHelper.getAltitude(e);this._isWorldDown&&r<t&&(0,s.k)(O.ray.direction,O.ray.direction),this._extensionType===w.GROUND_RAY&&null!=t&&(O.c1=Math.abs(r-t));break}}if(!(0,l.ig)(r.frustum,O))return this._updateLineSegmentFinite(t);const i=(0,a.j1)(O,b),n=(0,a.mO)(O,D);return(0,c.Cr)(i,n,t)}_updateVertexAttributesObject3D(e,t){const r=e.geometries[0].getMutableAttribute(g.r.POSITION)?.data;if(!r)return;let s=0;for(const e of this._lineVertices(t))r[s++]=e[0],r[s++]=e[1],r[s++]=e[2];e.geometryVertexAttributeUpdated(e.geometries[0],g.r.POSITION)}_updateVertexAttributesDraped(e,t){const r=e.getMutableAttribute(g.r.POSITION)?.data;if(!r)return;let s=0;for(const e of this._lineVertices(t))r[s++]=e[0],r[s++]=e[1],r[s++]=p.bi;e.invalidateBoundingInfo()}*_lineVertices(e){this.extensionType===w.FADED?(yield(0,c.sd)(e,-this.fadedExtensions.start,b),yield(0,c.sd)(e,0,b),yield(0,c.sd)(e,1,b),yield(0,c.sd)(e,1+this.fadedExtensions.end,b)):(yield(0,c.sd)(e,0,b),yield(0,c.sd)(e,1,b))}}function R(e){e.geometries=[]}const O=(0,a.vt)(),b=(0,i.vt)(),D=(0,i.vt)(),x=(0,c.vt)();var w,S;(S=w||(w={}))[S.LINE=0]="LINE",S[S.RAY=1]="RAY",S[S.GROUND_RAY=2]="GROUND_RAY",S[S.FADED=3]="FADED";const G=1/3,P={start:G,end:G}},83157:(e,t,r)=>{r.d(t,{l:()=>y});var s=r(4506),i=r(80347),n=r(19913),o=r(74772),a=r(76982),l=r(42722),c=r(46373),u=r(11631),d=r(87795),h=r(5822),p=r(93129),_=r(11519),m=r(74316),f=r(33763),g=r(21561);class y extends d.X{constructor(e){super(e),this._material=null,this._texture=null,this._geometry=null,this._size=3,this._color=(0,a.fA)(1,0,1,1),this._pixelSnappingEnabled=!0,this._primitive="square",this._outlineSize=1,this._outlineColor=(0,a.fA)(1,1,1,1),this._elevationInfo=null,this.applyProperties(e)}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this.recreateGeometry()}get size(){return this._size}set size(e){if(e!==this._size){const t=this._preferredTextureSize;this._size=e,t<this._preferredTextureSize?this.recreate():this._updateSizeAttribute()}}get color(){return this._color}set color(e){(0,o.a)(e,this._color)||((0,o.c)(this._color,e),this._updateMaterial())}get pixelSnappingEnabled(){return this._pixelSnappingEnabled}set pixelSnappingEnabled(e){this._pixelSnappingEnabled!==e&&(this._pixelSnappingEnabled=e,this._updateMaterial())}get primitive(){return this._primitive}set primitive(e){this._primitive!==e&&(this._primitive=e,this.recreate())}get outlineSize(){return this._outlineSize}set outlineSize(e){e!==this._outlineSize&&(this._outlineSize=e,this._updateMaterial())}get outlineColor(){return this._outlineColor}set outlineColor(e){(0,o.a)(e,this._outlineColor)||((0,o.c)(this._outlineColor,e),this._updateMaterial())}get elevationInfo(){return this._elevationInfo}set elevationInfo(e){this._elevationInfo=e,this.recreateGeometry()}_updateMaterial(){this._material&&this._material.setParameters(this._materialParameters)}_updateSizeAttribute(){const e=this.object;if(null==e)return;const t=e.geometries[0];if(null==t)return;const r=t.getMutableAttribute(f.r.SIZE).data,s=this._geometrySize;r[0]=s,r[1]=s,e.geometryVertexAttributeUpdated(e.geometries[0],f.r.SIZE)}get _materialParameters(){return{color:this._color,textureIsSignedDistanceField:!0,sampleSignedDistanceFieldTexelCenter:(0,_.ny)(this._primitive),distanceFieldBoundingBox:R,occlusionTest:!1,outlineColor:this._outlineColor,outlineSize:this._outlineSize,textureId:this._texture?.id,polygonOffset:!1,shaderPolygonOffset:0,drawInSecondSlot:!0,depthEnabled:!1,pixelSnappingEnabled:this.pixelSnappingEnabled,isDecoration:this.isDecoration}}get _geometrySize(){return this._size/v}createExternalResources(){this._texture=(0,_.sZ)(this._primitive,this._preferredTextureSize),this._material=new g.R(this._materialParameters);const e=this.view._stage;this._texture.load(e.renderView.renderingContext),e.add(this._texture)}destroyExternalResources(){this._texture&&(this.view._stage.remove(this._texture),this._texture.dispose(),this._texture=null),this._material=null}createGeometries(e){const t=this._createRenderGeometry();null!=t&&e.addGeometry(t)}forEachExternalMaterial(e){this._material&&e(this._material)}get _preferredTextureSize(){return(0,s.qE)(2*this._geometrySize,16,128)}calculateMapBounds(e){const t=this.object?.geometries[0];if(!t)return!1;const r=t.attributes.get(f.r.POSITION).data;return(0,l.F)(r,this.view.renderCoordsHelper.spatialReference,O,this.view.spatialReference),(0,c.Hq)(e,O),!0}_createRenderGeometry(){const{geometry:e,_material:t}=this;if(null==e||null==t)return null;const{renderCoordsHelper:r,elevationProvider:s}=this.view,n=(0,h.nG)(e,s,p.F.fromElevationInfo(this.elevationInfo),r),o=(0,i.s)(u.rq.get(),e.x,e.y,n),a=u.rq.get();(0,l.F)(o,e.spatialReference,a,r.spatialReference);const c=this._geometrySize;return(0,m.DJ)(t,null,a,null,[c,c],[0,0,0,1])}}const v=_.CN,R=[v/2,v/2,1-v/2,1-v/2],O=(0,n.vt)()},57657:(e,t,r)=>{r.d(t,{n:()=>b});var s=r(61985),i=r(25336),n=r(26110),o=r(80347),a=r(19913),l=r(74772),c=r(76982),u=r(11631),d=r(82320),h=r(14788),p=r(14583),_=r(10941),m=r(53633),f=r(74316),g=r(31272),y=r(35537),v=r(33763),R=r(29239),O=r(16596);class b extends h.X{constructor(e){super(e),this._maxSize=0,this._position=(0,a.vt)(),this._up=(0,a.vt)(),this._right=(0,a.vt)(),this._renderOccluded=g.m$.OccludeAndTransparent,this._color=(0,c.fA)(1,0,0,1),this._outlineColor=(0,c.fA)(0,0,0,1),this._outlineSize=0,this._size=32,this._outlineRenderOccluded=g.m$.Opaque,this.applyProperties(e)}createObject3DResourceFactory(e){return{view:e,createResources:e=>this._createObject3DResources(e),destroyResources:()=>{},cameraChanged:()=>this._updateTransformObject3D()}}createDrapedResourceFactory(e){return{view:e,createResources:()=>this._createDrapedResources(),destroyResources:D}}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateQuadMaterial())}get color(){return this._color}set color(e){(0,l.c)(this._color,e),this._updateQuadMaterial()}get outlineColor(){return this._outlineColor}set outlineColor(e){(0,l.c)(this._outlineColor,e),this._updateOutlineMaterial()}get outlineSize(){return this._outlineSize}set outlineSize(e){const t=0===this._outlineSize!=(0===e);this._outlineSize=e,t?this.recreateGeometry():this._updateOutlineMaterial()}get size(){return this._size}set size(e){e!==this._size&&(this._size=e,this._updateTransform())}get outlineRenderOccluded(){return this._outlineRenderOccluded}set outlineRenderOccluded(e){this._outlineRenderOccluded=e,this._updateOutlineMaterial()}set geometry({previous:e,center:t,next:r}){this._maxSize=Math.min((0,o.p)(t,e),(0,o.p)(t,r))/3,(0,o.n)(this._up,(0,o.f)(this._up,e,t)),(0,o.n)(this._right,(0,o.f)(this._right,r,t)),(0,o.c)(this._position,t),this.recreateGeometry()}_createObject3DResources(e){const t=new R.v(this._quadMaterialParameters),r=0===this._outlineSize?void 0:new O.W(this._outlineMaterialParameters);return this._createObject3DGeometries(e,t,r),{quadMaterial:t,outlineMaterial:r,forEach:e=>{e(t),r&&e(r)}}}_createObject3DGeometries(e,t,r){if((0,o.e)(this._up,a.uY)&&(0,o.e)(this._right,a.uY))return;const s=this._createGeometries(t,r);for(const t of s)e.addGeometry(t);this._updateTransformObject3D(e)}_createDrapedResources(){const e=new R.v(this._quadMaterialParameters),t=0===this._outlineSize?void 0:new O.W(this._outlineMaterialParameters),r=this._createGeometries(e,t).map((e=>new y.$(e)));return this._setTransformDraped(r),{quadMaterial:e,outlineMaterial:t,geometries:r,pixelRatioHandle:(0,s.wB)((()=>this.view.state.contentPixelRatio),(()=>{this.drapedResources.recreateGeometry()}))}}_createGeometries(e,t){const{up:r,right:s,corner:i}=this._getVertices(),n=function(e,t,r,s){return new m.V(s,[[v.r.POSITION,new _.n([0,0,0,...t,...e,...r],[0,1,2,1,2,3],3,!0)]])}(r,s,i,e);return t?[n,(0,f.Z8)(t,[r,i,s])]:[n]}_getVertices(){let e=this._up,t=this._right;const r=(0,o.g)(u.rq.get(),e,t);return this.isDraped&&(e=(0,o.c)(u.rq.get(),e),t=(0,o.c)(u.rq.get(),t),e[2]=0,t[2]=0,r[2]=0),{up:e,right:t,corner:r}}_updateTransform(){this.isDraped?this.drapedResources.recreateGeometry():this._updateTransformObject3D()}_updateTransformObject3D(e=this.object3dResources.object){if(!e)return;const t=this.view.state.camera,r=this._size*t.computeScreenPixelSizeAt(this._position),s=Math.min(this._maxSize,r);(0,i.kN)(x,this._position),(0,i.hs)(x,x,[s,s,s]),e.transformation=x}_setTransformDraped(e){if(0===e.length)return;const{view:{basemapTerrain:{overlayManager:t},state:{contentPixelRatio:r}}}=this,{_position:s,_size:n}=this,a=(0,o.c)(u.rq.get(),s);a[2]=p.bi;const l=w;l.spatialReference=t.renderer.spatialReference,l.x=a[0],l.y=a[1];const c=n*(this.view.overlayPixelSizeInMapUnits(l)*r),d=Math.min(this._maxSize,c);(0,i.kN)(x,a),(0,i.hs)(x,x,[d,d,1]);for(const t of e)t.transformation=x}get _quadMaterialParameters(){return{color:this._color,forceTransparentMode:!0,writeDepth:!1,polygonOffset:!0,renderOccluded:this._renderOccluded,isDecoration:this.isDecoration}}_updateQuadMaterial(){this.object3dResources.resources?.quadMaterial.setParameters(this._quadMaterialParameters),this.drapedResources.resources?.quadMaterial.setParameters(this._quadMaterialParameters)}get _outlineMaterialParameters(){return{color:this._outlineColor,width:this._outlineSize,renderOccluded:this._outlineRenderOccluded,isDecoration:this.isDecoration}}_updateOutlineMaterial(){this.object3dResources.resources?.outlineMaterial?.setParameters(this._outlineMaterialParameters),this.drapedResources.resources?.outlineMaterial?.setParameters(this._outlineMaterialParameters)}}function D(e){e.pixelRatioHandle.remove(),e.geometries=[]}const x=(0,n.vt)(),w=(0,d.T)(0,0,void 0,null)},28535:(e,t,r)=>{r.d(t,{e:()=>s});class s{constructor(e){this.vertexHandle=null,this.excludeFeature=null,this.visualizer=null,this.selfSnappingZ=null,this.drawConstraints=null,this.editGeometryOperations=e.editGeometryOperations,this.elevationInfo=e.elevationInfo,this.pointer=e.pointer,this.vertexHandle=e.vertexHandle,this.excludeFeature=e.excludeFeature,this.feature=e.feature,this.visualizer=e.visualizer,this.selfSnappingZ=e.selfSnappingZ,this.drawConstraints=e.drawConstraints}get coordinateHelper(){return this.editGeometryOperations.data.coordinateHelper}get spatialReference(){return this.coordinateHelper.spatialReference}}},51720:(e,t,r)=>{r.d(t,{L:()=>h});var s=r(57725),i=r(37623),n=r(61985),o=r(92801),a=r(96124),l=r(19541),c=r(66019),u=r(28535),d=r(49437);function h({predicate:e=()=>!0,snappingManager:t,snappingContext:r,updatingHandles:a,useZ:h=!0}){const g=new c.rh;if(null==t)return{snappingStep:[f,g],cancelSnapping:f};let y,v=null,R=null,O=null;const b=()=>{v=(0,s.DC)(v),t.doneSnapping(),R?.frameTask.remove(),R=null,y=(0,s.xt)(y),O=null},D=(x=t,w=h,S=g,(0,i.sg)((async({frameTask:e,point:t,scenePoint:r,context:s,event:i,delta:n,getLastState:a},l)=>{const c=await e.schedule((()=>x.snap({point:t,scenePoint:r,context:s,signal:l})),l);if(c.valid){let r=await e.schedule((()=>c.apply()),l);const u=a();null!=u.point&&t!==u.point&&(r=x.update({point:u.point,scenePoint:u.scenePoint,context:s})),null!=u.updatePoint&&(0,o.CI)(r,u.updatePoint)||(m(i.mapEnd,r,n,w),S.execute(i))}})));var x,w,S;let G=null,P=null,E=null;return{snappingStep:[s=>{if(!e(s))return s;const{action:o}=s;if("start"===o){const{info:e}=s,i=function(e){return"3d"===e.type?e.resourceController.scheduler.registerTask(d.W6.SNAPPING):d.nu}(t.view);if(R=function(e,t,r){return{context:new u.e({editGeometryOperations:e.editGeometryOperations,elevationInfo:e.elevationInfo,pointer:e.pointer,vertexHandle:null!=t.info?t.info.handle:null,excludeFeature:e.excludeFeature,feature:e.feature,visualizer:e.visualizer}),originalPos:null!=t.snapOrigin?e.coordinateHelper.vectorToDehydratedPoint(t.snapOrigin):t.mapStart,originalScenePos:null!=t.scenePoints?t.scenePoints.sceneStart:null,frameTask:r}}(r,s,i),R.context.selfSnappingZ=null,!h&&null!=e){const t=function(e,t){if(!e.hasZ())return null;const r=t.vertices;let s=null;for(const t of r){const r=e.getZ(t.pos);if(null!=s&&null!=r&&Math.abs(r-s)>1e-6)return null;null==s&&(s=r)}return s}(r.coordinateHelper,e.handle.component);null!=t&&(R.context.selfSnappingZ={value:t,elevationInfo:r.elevationInfo??l.qt})}}if(null!=R){const{context:e,originalScenePos:r,originalPos:l}=R,{mapEnd:c,mapStart:u,scenePoints:d}=s,f=p(l,_(c,u)),g=_(u,l),b={...s,action:"update"},x=R.context,w=function(e,t){return null==e||null==t?null:p(e,_(t.sceneEnd,t.sceneStart))}(r,d),S=t.update({point:f,scenePoint:w,context:e});if(E=S,m(c,S,g,h),G=f,P=w,"end"!==o){const{frameTask:e}=R;null==v&&(v=new AbortController),O=t=>{a.addPromise((0,i.QZ)(D({frameTask:e,event:b,context:x,point:f,scenePoint:w,delta:g,getLastState:()=>({point:G,scenePoint:P,updatePoint:t.forceUpdate?null:E})},v.signal)))},O({forceUpdate:!1}),null==y&&(y=(0,n.wB)((()=>t.options.effectiveEnabled),(()=>O?.({forceUpdate:!0}))))}}return"end"===o&&b(),s},g],cancelSnapping:e=>(b(),e)}}function p(e,[t,r,s]){const i=(0,a.EL)(e);return i.x+=t,i.y+=r,i.hasZ&&(i.z+=s),i}function _(e,t){const r=e.hasZ&&t.hasZ?e.z-t.z:0;return[e.x-t.x,e.y-t.y,r]}function m(e,t,[r,s,i],n){e.x=t.x+r,e.y=t.y+s,n&&e.hasZ&&t.hasZ&&(e.z=t.z+i)}function f(e){return e}},36598:(e,t,r)=>{r.d(t,{b:()=>c});var s=r(70214),i=r(46997),n=r(56142),o=r(27411),a=r(25674),l=r(43457);class c{draw(e,t){const r=function(e){const t=[];for(const r of e){let e=!0;for(const s of t)if(r.equals(s)){e=!1;break}e&&t.push(r)}return t}(e),c=this.sortUniqueHints(r),u=[];for(const e of c)e instanceof i.v&&u.push(this.visualizeIntersectionPoint(e,t)),e instanceof n.c&&u.push(this.visualizeLine(e,t)),e instanceof o.r&&u.push(this.visualizeParallelSign(e,t)),e instanceof l.l&&u.push(this.visualizeRightAngleQuad(e,t)),e instanceof a._&&u.push(this.visualizePoint(e,t));return(0,s.vE)(u)}sortUniqueHints(e){return e}}},25674:(e,t,r)=>{r.d(t,{_:()=>n});var s=r(80347),i=r(12288);class n extends i.m{constructor(e,t,r){super(t,r),this.point=e}equals(e){return e instanceof n&&(0,s.e)(this.point,e.point)}}}}]);