"use strict";(self.webpackChunkarcgis_node=self.webpackChunkarcgis_node||[]).push([[4838],{87373:(e,t,i)=>{i.d(t,{P:()=>P});var s=i(57888),r=i(80347),n=i(19913),o=i(74772),a=i(53357),l=i(88133),h=i(46373),c=i(75644),d=i(82320),u=i(19541),p=i(44223),_=i(14788),m=i(95351),g=i(93129),v=i(41410),f=i(86652),y=i(31272),w=i(35537),b=i(33763),R=i(16596);class P extends _.X{constructor(e){super(e),this._attachmentOrigin=(0,d.T)(0,0,0,null),this._attachmentOriginDirty=!0,this.events=new s.A,this._geometry=null,this._width=1,this._color=(0,a.fA)(1,0,1,1),this._innerWidth=0,this._innerColor=(0,a.fA)(1,1,1,1),this._stipplePattern=null,this._stippleOffColor=null,this._falloff=0,this._elevationInfo=null,this._laserlineStyle=null,this._laserlineEnabled=!1,this._renderOccluded=y.m$.OccludeAndTransparentStencil,this._attachmentOrigin.spatialReference=e.view.spatialReference,this._laserline=new m.o({view:e.view,isDecoration:e.isDecoration}),this.applyProperties(e),this.attached=e.attached??!0}destroy(){this._laserline.destroy(),super.destroy()}createObject3DResourceFactory(e){return{view:e,createResources:e=>this._createObject3DResources(e),destroyResources:C,recreateGeometry:(e,t)=>{e.geometries.length=0,this._recreateGeometry(t,e.material,e.geometries)}}}createDrapedResourceFactory(e){return{view:e,createResources:()=>this._createDrapedResources(),destroyResources:C,recreateGeometry:e=>{e.geometries=this._createRenderGeometriesDraped(e.material),this._attachmentOriginChanged()}}}get _laserlineAttached(){return this.attached&&this.visible&&null!=this._laserlineStyle&&!this.isDraped&&this.laserlineEnabled}onAttachedChange(e){this._laserline.attached=this._laserlineAttached,e&&this._attachmentOriginChanged()}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this.recreateGeometry()}get width(){return this._width}set width(e){e!==this._width&&(this._width=e,this._updateMaterial())}get color(){return this._color}set color(e){(0,o.a)(e,this._color)||((0,o.c)(this._color,e),this._updateMaterial())}get innerWidth(){return this._innerWidth}set innerWidth(e){e!==this._innerWidth&&(this._innerWidth=e,this._updateMaterial())}get innerColor(){return this._innerColor}set innerColor(e){(0,o.a)(e,this._innerColor)||((0,o.c)(this._innerColor,e),this._updateMaterial())}get stipplePattern(){return this._stipplePattern}set stipplePattern(e){const t=null!=e!=(null!=this._stipplePattern);this._stipplePattern=e,t?this.recreate():this._updateMaterial()}get stippleOffColor(){return this._stippleOffColor}set stippleOffColor(e){e&&this._stippleOffColor&&(0,o.a)(e,this._stippleOffColor)||(this._stippleOffColor=e?(0,a.o8)(e):null,this._updateMaterial())}get falloff(){return this._falloff}set falloff(e){e!==this._falloff&&(this._falloff=e,this._updateMaterial())}get elevationInfo(){return this._elevationInfo}set elevationInfo(e){this._elevationInfo=e,this.recreateGeometry()}get laserlineStyle(){return this._laserlineStyle}set laserlineStyle(e){this._laserlineStyle=e,this._laserline.attached=this._laserlineAttached,null!=e&&(this._laserline.style=e)}get laserlineEnabled(){return this._laserlineEnabled}set laserlineEnabled(e){this._laserlineEnabled!==e&&(this._laserlineEnabled=e,this._laserline.attached=this._laserlineAttached)}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial())}get attachmentOrigin(){if(!this._attachmentOriginDirty)return this._attachmentOrigin;const e=this.object3dResources.resources?.geometries;if(!e||0===e.length)return null;(0,r.s)(D,0,0,0);let t=0;for(const i of e)i.computeAttachmentOrigin(O)&&((0,r.g)(D,D,O),t++);return 0===t?null:((0,r.j)(D,D,1/t),this.view.renderCoordsHelper.fromRenderCoords(D,this._attachmentOrigin),this._attachmentOriginDirty=!1,this._attachmentOrigin)}_updateMaterial(){null!=this.object3dResources.resources&&this.object3dResources.resources.material.setParameters(this._materialParameters),null!=this.drapedResources.resources&&this.drapedResources.resources.material.setParameters(this._materialParameters)}get _isClosed(){return null!=this.geometry&&"polygon"===this.geometry.type}get _materialParameters(){return{width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,stipplePreferContinuous:!1,isClosed:this._isClosed,falloff:this._falloff,innerColor:this._innerColor,innerWidth:this._innerWidth,join:"round",hasPolygonOffset:!0,renderOccluded:this._normalizedRenderOccluded,isDecoration:this.isDecoration}}get _normalizedRenderOccluded(){return this.isDraped&&this._renderOccluded===y.m$.OccludeAndTransparentStencil?y.m$.OccludeAndTransparent:this._renderOccluded}_recreateGeometry(e,t,i){this._createRenderGeometries(t,i);for(const t of i)e.addGeometry(t);this._attachmentOriginChanged()}_attachmentOriginChanged(){this._attachmentOriginDirty=!0,this.events.emit("attachment-origin-changed")}_createObject3DResources(e){const t=new R.W(this._materialParameters),i=new Array;return this._recreateGeometry(e,t,i),{material:t,geometries:i,forEach:e=>{e(t),i.forEach(e)}}}_createDrapedResources(){const e=new R.W(this._materialParameters);return{material:e,geometries:this._createRenderGeometriesDraped(e)}}_createRenderGeometriesDraped(e){const{geometry:t,view:i}=this,s=i.basemapTerrain.spatialReference;return null==t||null==s?[]:(0,f.A)(t,s).lines.map((({position:t})=>{const r={overlayInfo:{spatialReference:s,renderCoordsHelper:i.renderCoordsHelper},attributeData:{position:t},removeDuplicateStartEnd:this._isClosed};return new w.$((0,v.t)(e,r))}))}calculateMapBounds(e){if(null==this.object3dResources.resources)return!1;const t=this.view.renderCoordsHelper;for(const i of this.object3dResources.resources.geometries){const s=i.attributes.get(b.r.POSITION),r=(0,c.jh)(s.data.length);(0,l.projectBuffer)(s.data,t.spatialReference,0,r,this.view.spatialReference,0,s.data.length/3),(0,h.Hq)(e,r)}return!0}_createRenderGeometries(e,t){const i=this.geometry;if(null==i)return;const s=(0,f.C)(i,this.view.elevationProvider,this.view.renderCoordsHelper,g.F.fromElevationInfo(this.elevationInfo??new p.A({mode:(0,u.w7)(i,null)}))),r=new Array;for(const{position:i,mapPositions:n}of s.lines){const s={mapPositions:n,attributeData:{position:i},removeDuplicateStartEnd:this._isClosed};t.push((0,v.t)(e,s)),r.push(i)}this._laserline.pathVerticalPlane=r}}function C(e){e.geometries=[]}const O=(0,n.vt)(),D=(0,n.vt)()},51467:(e,t,i)=>{i.d(t,{B:()=>r});i(6273);var s=i(61985);class r{get isDecoration(){return this._isDecoration}set isDecoration(e){this._isDecoration=e}constructor(e){this._isDecoration=!1,this._attached=!1,this._resourcesCreated=!1,this._visible=!0,this.view=e.view,this._handle=(0,s.wB)((()=>e.view.ready),(e=>{this._resourcesCreated&&(e?this._createResources():this._destroyResources())}))}applyProperties(e){let t=!1;for(const i in e)i in this&&("attached"===i?t=e[i]:this[i]=e[i]);this.attached=t}destroy(){this.attached=!1,this._handle.remove()}get attached(){return this._attached}set attached(e){e!==this._attached&&this.view._stage&&(this._attached=e,this._attached&&!this._resourcesCreated?this._createResources():!this._attached&&this._resourcesCreated&&this._destroyResources(),this.onAttachedChange(e))}onAttachedChange(e){}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this.attached&&this.updateVisibility(e))}_createResources(){this.createResources(),this._resourcesCreated=!0,this.updateVisibility(this.visible)}_destroyResources(){this.destroyResources(),this._resourcesCreated=!1}}},65194:(e,t,i)=>{i.d(t,{y:()=>a});var s=i(82392),r=i(57888),n=i(81482),o=(i(6273),i(80861),i(67498),i(26325));let a=class extends r.A.EventedAccessor{constructor(e){super(e),this.tracking=!1,this.displaying=!1,this.isDraped=!1}};(0,s._)([(0,n.MZ)({constructOnly:!0})],a.prototype,"graphic",void 0),(0,s._)([(0,n.MZ)()],a.prototype,"tracking",void 0),(0,s._)([(0,n.MZ)()],a.prototype,"displaying",void 0),(0,s._)([(0,n.MZ)()],a.prototype,"isDraped",void 0),a=(0,s._)([(0,o.$)("esri.views.3d.layers.graphics.GraphicState")],a)},69168:(e,t,i)=>{i.r(t),i.d(t,{ElevationProfileView3D:()=>A});var s=i(56802),r=i(57725),n=i(61985),o=i(34677),a=i(22136),l=i(3132),h=i(70214),c=i(37623),d=i(19541),u=i(68816),p=i(87373),_=i(65194),m=i(31272),g=i(96383);class v{constructor(e){this._params=e,this._highlightTask=null,this._highlightHandle=null,this._visualElementHandle=null,this._settings=new u.w({getTheme:()=>this._params.view.effectiveTheme})}destroy(){this.remove()}remove(){this._highlightTask=(0,r.DC)(this._highlightTask),this._highlightHandle=(0,r.xt)(this._highlightHandle),this._visualElementHandle=(0,r.xt)(this._visualElementHandle)}showHighlight(e){if(this.remove(),null==e||!f(e))return;const t=e.layer;this._highlightTask=(0,l.UT)((async i=>{const s=await this._params.view.whenLayerView(t);(0,c.Te)(i),(0,g.Of)(s)&&(this._highlightHandle=s.highlight(e))}))}showReshaping(e){if(this.remove(),null==e)return;const t=this._params.view,i=new p.P({view:t,geometry:f(e)?e.geometry:null,attached:!1,elevationInfo:(0,d.bh)(e),renderOccluded:m.m$.OccludeAndTransparentStencil,isDecoration:!0}),s=new _.y({graphic:e}),r=[(0,n.wB)((()=>s.isDraped),(e=>{i.isDraped=e})),s.on("changed",(()=>{i.geometry=f(e)?e.geometry:null})),t.trackGraphicState(s),t.maskOccludee(e),(0,h.DQ)(i)];this._settings.visualElements.lineObjects.outline.apply(i),i.attached=!0,this._visualElementHandle=(0,h.vE)(r)}}function f(e){return null!=e.geometry&&"polyline"===e.geometry.type}var y=i(82392),w=i(93814),b=i(73783),R=i(10565),P=i(81482),C=(i(6273),i(80861),i(67498),i(26325)),O=i(76982),D=i(38648);let E=class extends b.A{constructor(e){super(e),this._chartData=null,this._visualElements=[]}initialize(){const e=(0,R.n)((e=>{this._update(e)}),100);this.addHandles([(0,n.wB)((()=>({spatialReference:this.view.spatialReference,chartData:this._chartData})),e,n.pc),e])}destroy(){this._destroyVisualElements()}remove(){this._destroyVisualElements()}update(e){this._chartData=e}_update(e){const{chartData:t}=e;if(null==t)return this.remove();if(!t.refined)return;const i=this._visualElements,s=t.lines.filter((e=>e.viewVisualizationEnabled)),r=s.length;for(;i.length>r;)i.pop().destroy();const n=(0,o.zj)().profileLinesStyle3D;for(;i.length<r;){const e=new p.P({view:this.view,elevationInfo:{mode:"absolute-height",offset:0},innerWidth:n.width-n.outlineSize,width:n.width,falloff:n.falloff,color:n.outlineColor,renderOccluded:n.renderOccluded,isDecoration:!0});i.push(e)}const a=e.spatialReference;for(let e=0;e<r;++e){const t=i[e],n=s[r-1-e];t.geometry=this._createLineGeometry(n,a),t.innerColor=(0,O.ci)(w.A.toUnitRGBA(n.color))}}_createLineGeometry(e,t){const i=e.samples??[],s=i.length-1,r=[];let n=[];for(let e=0;e<=s;e++){const{x:t,y:o,z:a}=i[e];null!=a&&n.push([t,o,a]),e!==s&&null!=a||!n.length||(r.push(n),n=[])}return new D.A({paths:r,hasZ:!0,spatialReference:t})}_destroyVisualElements(){this._visualElements.forEach((e=>e.destroy())),this._visualElements.length=0}};(0,y._)([(0,P.MZ)()],E.prototype,"view",void 0),(0,y._)([(0,P.MZ)()],E.prototype,"_chartData",void 0),E=(0,y._)([(0,C.$)("esri.widgets.ElevationProfile.support.ProfileLines3D")],E);class A{constructor(e,t){this._handles=new s.A,this._inputRepresentation=new v({view:e}),this._hoveredPoints=new a.t({view:e}),this._profileLines=new E({view:e}),this._handles.add([(0,n.wB)((()=>t.viewModel.hoveredPoints),(e=>this._hoveredPoints.update(e)),n.pc),(0,n.wB)((()=>{const{state:e,editable:i,highlightEnabled:s,viewModel:r}=t,n=r.input;return n&&(n.commitProperty("geometry"),n.commitProperty("layer")),{input:n,state:e,editable:i,highlightEnabled:s}}),(e=>this._updateInputRepresentation(e)),n.pc),(0,n.wB)((()=>t.viewModel.chartData),(e=>this._profileLines.update(e)),n.pc),(0,n.wB)((()=>t.viewModel.input?.geometry),(()=>{this._profileLines.remove()}),n.pc)])}destroy(){this._handles=(0,r.pR)(this._handles),this._inputRepresentation=(0,r.pR)(this._inputRepresentation),this._hoveredPoints=(0,r.pR)(this._hoveredPoints),this._profileLines=(0,r.pR)(this._profileLines)}_updateInputRepresentation({input:e,state:t,editable:i,highlightEnabled:s}){const r=this._inputRepresentation;if(!s)return r.remove();t===o.o8.Selected?r.showHighlight(e):t!==o.o8.Created||i?r.remove():r.showReshaping(e)}}},22136:(e,t,i)=>{i.d(t,{t:()=>d});var s=i(82392),r=i(73783),n=i(40377),o=i(61985),a=i(81482),l=(i(6273),i(80861),i(67498),i(26325)),h=i(34677),c=i(74512);let d=class extends r.A{constructor(e){super(e),this._hoveredPoints=new n.A}initialize(){this.addHandles((0,o.wB)((()=>this._hoveredPoints.toArray().map((({anchor:e,element:t})=>({screenLocation:e.screenLocation,element:t})))),(e=>{for(const{screenLocation:t,element:i}of e)t&&(i.style.transform=`translate(${t.x}px, ${t.y}px)`)}),o.pc))}destroy(){this._hoveredPoints.drain((e=>this._destroyHoveredPoint(e)))}update(e){const t=this.view,i=this._hoveredPoints,s=e.length;for(;this._hoveredPoints.length>s;)this._destroyHoveredPoint(this._hoveredPoints.pop());for(;this._hoveredPoints.length<s;){const e=this._makeHoveredPoint();i.push(e),t.surface?.appendChild(e.element)}for(let t=0;t<s;++t){const r=i.at(s-1-t),n=e[t];this._updateHoveredPoint(r,n)}}_makeHoveredPoint(){const{size:e,borderStyle:t,borderColor:i,borderWidth:s,boxShadow:r}=(0,h.zj)().hoveredPointsStyle,n=this.view,o=new c.A({view:n,screenLocationEnabled:!0}),a=document.createElement("div"),l=a.style;return l.position="absolute",l.top="0",l.left="0",l.contain="strict",l.boxSizing="border-box",l.width=`${e}px`,l.height=`${e}px`,l.marginTop=`-${e/2}px`,l.marginLeft=`-${e/2}px`,l.border=`${t} ${s}px ${i}`,l.borderRadius=`${e}px`,l.boxShadow=r,{anchor:o,element:a}}_updateHoveredPoint({anchor:e,element:t},i){e.screenLocationEnabled=!0,e.location=i.hoveredPoint;const s=t.style;s.display="block",s.background=i.color.toCss()}_destroyHoveredPoint({anchor:e,element:t}){e.destroy(),this.view.surface?.removeChild(t)}};(0,s._)([(0,a.MZ)()],d.prototype,"view",void 0),(0,s._)([(0,a.MZ)()],d.prototype,"_hoveredPoints",void 0),d=(0,s._)([(0,l.$)("esri.widgets.ElevationProfile.support.HoveredPoints")],d)},74512:(e,t,i)=>{i.d(t,{A:()=>c});var s=i(82392),r=i(57888),n=i(61985),o=i(81482),a=(i(6273),i(80861),i(67498),i(26325)),l=i(34561);let h=class extends r.A.EventedAccessor{constructor(e){super(e),this.location=null,this.screenLocationEnabled=!1,this.view=null,this.addHandles([(0,n.z7)((()=>{const e=this.screenLocationEnabled?this.view:null;return e?[e.size,"3d"===e.type?e.camera:e.viewpoint]:null}),(()=>this.notifyChange("screenLocation"))),(0,n.wB)((()=>this.screenLocation),((e,t)=>{null!=e&&null!=t&&this.emit("view-change")}))])}destroy(){this.view=null}get screenLocation(){const{location:e,view:t,screenLocationEnabled:i}=this,s=t?.spatialReference,r=s?(0,l.projectOrLoad)(e,s).geometry:null;return i&&r&&t?.ready?t.toScreen(r):null}};(0,s._)([(0,o.MZ)()],h.prototype,"location",void 0),(0,s._)([(0,o.MZ)()],h.prototype,"screenLocation",null),(0,s._)([(0,o.MZ)()],h.prototype,"screenLocationEnabled",void 0),(0,s._)([(0,o.MZ)()],h.prototype,"view",void 0),h=(0,s._)([(0,a.$)("esri.widgets.support.AnchorElementViewModel")],h);const c=h}}]);