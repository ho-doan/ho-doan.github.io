"use strict";(self.webpackChunkarcgis_node=self.webpackChunkarcgis_node||[]).push([[3727],{63727:(e,t,i)=>{i.r(t),i.d(t,{default:()=>h});var s=i(82392),r=i(40377),a=i(61985),n=i(81482),o=(i(6273),i(80861),i(67498),i(26325)),d=i(93766),l=i(5914),p=i(24775);let y=class extends((0,l.A)((0,d.w)(p.A))){constructor(){super(...arguments),this.type="catalog-dynamic-group-3d",this.layerViews=new r.A}initialize(){this.addHandles([this.enableLayerUpdates(),(0,a.z7)((()=>this.view.stationary),(()=>this.updateLayers()))])}};(0,s._)([(0,n.MZ)()],y.prototype,"layerViews",void 0),(0,s._)([(0,n.MZ)()],y.prototype,"parent",void 0),(0,s._)([(0,n.MZ)()],y.prototype,"view",void 0),y=(0,s._)([(0,o.$)("esri.views.3d.layers.CatalogDynamicGroupLayerView3D")],y);const h=y},93766:(e,t,i)=>{i.d(t,{w:()=>p});var s=i(82392),r=i(70214),a=i(37623),n=i(61985),o=i(81482),d=(i(6273),i(80861),i(67498),i(26325)),l=i(4197);const p=e=>{let t=class extends e{constructor(){super(...arguments),this.slicePlaneEnabled=!1,this.supportsHeightUnitConversion=!1}postscript(){super.postscript(),(0,l.jI)(this.layer)&&this.addResolvingPromise(this._validateHeightModelInfo())}async _validateHeightModelInfo(){const e=new AbortController,t=e.signal;this.addHandles((0,r.hA)((()=>e.abort()))),await(0,n.C_)((()=>this.view.defaultsFromMap?.heightModelInfoReady),t),(0,a.Te)(t);const i=(0,l.Hu)(this.layer,this.view.heightModelInfo,this.supportsHeightUnitConversion);if(i)throw i}};return(0,s._)([(0,o.MZ)()],t.prototype,"view",void 0),(0,s._)([(0,o.MZ)()],t.prototype,"slicePlaneEnabled",void 0),t=(0,s._)([(0,d.$)("esri.views.3d.layers.LayerView3D")],t),t}},5914:(e,t,i)=>{i.d(t,{A:()=>h});var s=i(82392),r=i(40377),a=i(70214),n=i(80861),o=i(37623),d=i(80189),l=i(81482),p=(i(6273),i(67498),i(26325));const y=Symbol(),h=e=>{let t=class extends e{constructor(){super(...arguments),this.layerViews=new r.A,this._debouncedUpdate=(0,o.sg)((async()=>{const{layer:e,parent:t}=this,i=t?.footprintLayerView;let s=[];const r=this._createQuery();if(r&&i){const{features:t}=await i.queryFeatures(r);this.suspended||(s=t.map((t=>e.acquireLayer(t))))}this.removeHandles(y),this.addHandles(s,y)}))}get creatingLayerViews(){return this.view?.layerViewManager.isCreatingLayerViewsForLayer(this.layer)??!1}isUpdating(){return this.creatingLayerViews||this.layer.updating||this.layerViews.some((e=>e.updating))}enableLayerUpdates(){return(0,a.vE)([this._updatingHandles.addWhen((()=>!1===this.parent?.footprintLayerView?.dataUpdating),(()=>this.updateLayers())),this._updatingHandles.add((()=>[this.layer.maximumVisibleSublayers,this.layer.parent?.orderBy,this.parent?.footprintLayerView?.filter,this.parent?.footprintLayerView?.timeExtent,this.suspended]),(()=>this.updateLayers())),(0,a.hA)((()=>this.removeHandles(y)))])}updateLayers(){this.suspended?this.removeHandles(y):this._updatingHandles.addPromise((0,o.QZ)(this._debouncedUpdate()).catch((e=>{n.A.getLogger(this).error(e)})))}_createQuery(){const e=this.parent?.footprintLayerView,t=this.layer?.parent;if(!e||!t||t.destroyed)return null;const{layer:{maximumVisibleSublayers:i},view:{scale:s}}=this;if(!i)return null;const{itemTypeField:r,itemSourceField:a,itemNameField:n,minScaleField:o,maxScaleField:l,objectIdField:p,orderBy:y}=t,h=(0,d.m)(`${o} IS NULL OR ${s} <= ${o} OR ${o} = 0`,`${l} IS NULL OR ${s} >= ${l}`),u=y?.find((e=>e.field&&!e.valueExpression)),c=e.createQuery();if(c.returnGeometry=!1,c.num=i,c.outFields=[p,a,n],c.where=(0,d.m)(c.where,h),null!=this.unsupportedItemTypes){const e=`${r} NOT IN (${this.unsupportedItemTypes.map((e=>`'${e}'`))})`;c.where=(0,d.m)(c.where,e)}return u?.field&&(c.orderByFields=[`${u.field} ${"descending"===u.order?"DESC":"ASC"}`],c.outFields.push(u.field)),c}};return(0,s._)([(0,l.MZ)({readOnly:!0})],t.prototype,"creatingLayerViews",null),(0,s._)([(0,l.MZ)()],t.prototype,"layer",void 0),(0,s._)([(0,l.MZ)()],t.prototype,"layerViews",void 0),(0,s._)([(0,l.MZ)({readOnly:!0})],t.prototype,"unsupportedItemTypes",void 0),(0,s._)([(0,l.MZ)()],t.prototype,"parent",void 0),(0,s._)([(0,l.MZ)({readOnly:!0})],t.prototype,"isUpdating",null),t=(0,s._)([(0,p.$)("esri.views.layers.CatalogDynamicGroupLayerView")],t),t}}}]);